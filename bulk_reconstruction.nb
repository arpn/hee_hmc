(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    144012,       4173]
NotebookOptionsPosition[    134862,       4029]
NotebookOutlinePosition[    135295,       4046]
CellTagsIndexPosition[    135252,       4043]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Bulk reconstruction from EE (hep-th:2007.00010)", "Title",ExpressionUUID->"56df2183-e8f0-40f9-b484-1b00d0f38243"],

Cell[CellGroupData[{

Cell[TextData[{
 "Planar black hole in ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["AdS", "5"], TraditionalForm]],ExpressionUUID->
  "9e469e35-4a1c-4ad5-aca1-e9f46f3c1dfc"]
}], "Chapter",ExpressionUUID->"aa38f7fa-8e5f-4b9c-a5cf-966efaeb2a17"],

Cell[TextData[{
 "The metric is\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"g", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox["R", "2"], 
      SuperscriptBox["z", "2"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"b", "(", "z", ")"}]}], "d", " ", 
        SuperscriptBox["t", "2"]}], "+", 
       FractionBox[
        RowBox[{"d", " ", 
         SuperscriptBox["z", "2"]}], 
        RowBox[{"b", "(", "z", ")"}]], "+", 
       RowBox[{"d", 
        SuperscriptBox[
         OverscriptBox["x", "_"], "2"]}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"aad465c9-e053-4126-b011-fd301f77f284"],
 " ,\nwith\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"b", "(", "z", ")"}], "=", 
     RowBox[{"1", "-", 
      FractionBox[
       SuperscriptBox["z", "4"], 
       SuperscriptBox[
        SubscriptBox["z", "h"], "4"]]}]}], " ", ",", "\[IndentingNewLine]", 
    RowBox[{"T", "=", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"\[Pi]", " ", 
        SubscriptBox["z", "h"]}]], " ", "."}]}]}], TraditionalForm]],
  ExpressionUUID->"99d75c48-88f9-4a0a-b17e-4d3ec1be929a"],
 "\nThis is the background on top of which we work."
}], "Text",ExpressionUUID->"325fa363-c36d-454e-b1ee-06d36d375ca7"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Ansatz ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["AdS", "5"], TraditionalForm]],ExpressionUUID->
  "77cb2cd0-1086-46df-9d97-cf45a77ca181"],
 " finite-T system"
}], "Chapter",ExpressionUUID->"b3f80500-13a9-43a3-b32f-cbe215e07906"],

Cell[TextData[{
 "We work in a general static, homogeneous situation where the metric still \
is asymptotically ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["AdS", "5"], TraditionalForm]],ExpressionUUID->
  "4136da67-d078-4ece-a15a-6aca77901c7c"],
 " in the UV ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"z", "\[Rule]", "0"}], ")"}], TraditionalForm]],ExpressionUUID->
  "b217d118-3f7b-4fdb-a444-2b045139a613"],
 " and approaches a planar black hole in the IR ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"z", "\[Rule]", 
     SubscriptBox["z", "h"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "9c8d37f1-0e43-4a09-a912-31b9f2a2ce47"],
 "."
}], "Text",ExpressionUUID->"72a70943-f663-4ab6-ab5c-e14c40dc7760"],

Cell[TextData[{
 "The metric is taken to be\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"g", "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox["R", "2"], 
      SuperscriptBox["z", "2"]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        FractionBox[
         RowBox[{"b", "(", "z", ")"}], 
         SuperscriptBox[
          RowBox[{"a", "(", "z", ")"}], "2"]], "d", " ", 
        SuperscriptBox["t", "2"]}], "+", 
       RowBox[{
        FractionBox[
         SuperscriptBox[
          RowBox[{"a", "(", "z", ")"}], "2"], 
         RowBox[{"b", "(", "z", ")"}]], "d", " ", 
        SuperscriptBox["z", "2"]}], "+", 
       RowBox[{"d", 
        SuperscriptBox[
         OverscriptBox["x", "_"], "2"]}]}], ")"}]}]}], TraditionalForm]],
  ExpressionUUID->"bdf6f6cd-78a8-4921-b459-1baee7db48d9"],
 " ."
}], "Text",ExpressionUUID->"a5617d75-f9fb-4730-94a0-6e861bbf4d96"],

Cell[TextData[{
 "The function ",
 Cell[BoxData[
  FormBox[
   RowBox[{"a", "(", "z", ")"}], TraditionalForm]],ExpressionUUID->
  "7dcb393e-8784-4fe5-9ffe-ef5d5cbe8745"],
 " is\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"a", "(", "z", ")"}], "=", 
    RowBox[{"1", "+", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], 
       SubscriptBox["N", "basis"]], 
      RowBox[{
       SubscriptBox["a", "i"], "(", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z", "/", 
           SubscriptBox["z", "h"]}], ")"}], "i"], "-", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"z", "/", 
           SubscriptBox["z", "h"]}], ")"}], 
         RowBox[{
          SubscriptBox["N", "basis"], "+", "1"}]]}], ")"}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"ba52e17e-dc59-4222-bc8a-c06cee3d86d1"],
 " ,\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["a", "i"], "\[Element]", "\[DoubleStruckCapitalR]"}], 
   TraditionalForm]],ExpressionUUID->"dd7f34cd-6036-4c60-8f64-a8491ee8c7f6"],
 " s.t. ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{"i", "=", "1"}], "L"], 
     SubscriptBox["a", "i"]}], "=", "0"}], TraditionalForm]],ExpressionUUID->
  "992b77ca-6913-4561-809d-d691db44c2e6"],
 " and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["N", "basis"], "\[Element]", 
    SubscriptBox["\[DoubleStruckCapitalZ]", "+"]}], TraditionalForm]],
  ExpressionUUID->"15ddc32a-c399-4c69-a185-65efb56b4ed6"],
 " controls the number of polynomials we use. This function is built in such \
a way that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"a", "(", 
     RowBox[{"z", "\[Rule]", "0"}], ")"}], "=", 
    RowBox[{
     RowBox[{"a", "(", 
      RowBox[{"z", "\[Rule]", 
       SubscriptBox["z", "h"]}], ")"}], "=", "1"}]}], TraditionalForm]],
  ExpressionUUID->"72bdb1f8-b360-4e75-afd3-7a81db14ecdf"],
 " , meaning that the background is ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["AdS", "5"], TraditionalForm]],ExpressionUUID->
  "836facdf-f92f-4c5f-b898-1cca37368b05"],
 " in the UV and BH in the IR."
}], "Text",ExpressionUUID->"c89512ae-c7b7-4de0-95f0-c497db3a86c7"],

Cell[CellGroupData[{

Cell["Strip entropy/width integrals", "Section",ExpressionUUID->"e0849b28-46fd-4273-8f6b-3cd8b853bbe7"],

Cell["\<\
We write down these integrals explicitly in order to check that the \
integrator in the sampler works correctly and to generate test data.\
\>", "Text",ExpressionUUID->"79faac28-3299-4248-9cf0-05b78d5f2aba"],

Cell[TextData[{
 "Strip width is given by\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"l", "=", 
    RowBox[{"2", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", 
       SubscriptBox["z", "*"]], 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         FractionBox["z", 
          SubscriptBox["z", "*"]], ")"}], "3"], 
       FractionBox[
        RowBox[{"a", "(", "z", ")"}], 
        SqrtBox[
         RowBox[{"b", "(", "z", ")"}]]], 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"z", "/", 
             SubscriptBox["z", "*"]}], ")"}], "6"]}]]], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"93b82dd4-eb44-450b-a457-b2d8a32d149d"],
 "\nand the area of the strip is\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["A", 
     RowBox[{
      SuperscriptBox["R", "3"], "V"}]], "=", 
    RowBox[{"2", 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "\[Epsilon]", 
       SubscriptBox["z", "*"]], 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["z", "3"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox[
           RowBox[{"a", "(", "z", ")"}], 
           SqrtBox[
            RowBox[{"b", "(", "z", ")"}]]], 
          FractionBox["1", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"z", "/", 
                SubscriptBox["z", "*"]}], ")"}], "6"]}]]]}], "-", "1"}], 
        ")"}], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"5ff48324-9f2a-460a-ade8-9c592869c88e"],
 " ,\nwhere ",
 Cell[BoxData[
  FormBox["V", TraditionalForm]],ExpressionUUID->
  "36c6a928-7366-411b-a82f-cf9103c4f90b"],
 " is the volume of the transverse space ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["x", "2"], ",", 
     SubscriptBox["x", "3"]}], ")"}], TraditionalForm]],ExpressionUUID->
  "0e7fa6fa-cf04-428d-9819-52cca14303be"],
 " when the strip is ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "l"}], "/", "2"}], "\[LessEqual]", 
    SubscriptBox["x", "1"], "\[LessEqual]", 
    RowBox[{"l", "/", "2"}]}], TraditionalForm]],ExpressionUUID->
  "ad5b36fa-84b8-4a90-b97b-1f941440cf0e"],
 " .\nSince lattice data is for ",
 Cell[BoxData[
  FormBox[
   RowBox[{"dS", "/", "dl"}], TraditionalForm]],ExpressionUUID->
  "085ffb4b-411a-410e-8952-063bed77d485"],
 ", we\[CloseCurlyQuote]ll also compute this derivative. One can show that\n\
",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"d", " ", 
      SubscriptBox["S", "A"]}], 
     RowBox[{"d", " ", "l"}]], "=", 
    RowBox[{
     FractionBox[
      RowBox[{
       SuperscriptBox["R", "3"], "V"}], 
      RowBox[{"4", 
       SubscriptBox["G", "N"]}]], 
     FractionBox["1", 
      SuperscriptBox[
       SubscriptBox["z", "*"], "3"]]}]}], TraditionalForm]],ExpressionUUID->
  "1bed1ec9-8b3b-4559-b294-05c98e7605b1"],
 " .\nIn the following we work the dimensionless combination\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox["d", 
      RowBox[{"d", " ", "l"}]], 
     FractionBox[
      RowBox[{"4", 
       SubscriptBox["G", "N"], 
       SuperscriptBox[
        SubscriptBox["z", "h"], "3"], 
       SubscriptBox["S", "A"]}], 
      RowBox[{
       SuperscriptBox["R", "3"], "V"}]]}], "=", 
    FractionBox[
     SuperscriptBox[
      SubscriptBox["z", "h"], "3"], 
     SuperscriptBox[
      SubscriptBox["z", "*"], "3"]]}], TraditionalForm]],ExpressionUUID->
  "31146410-6ea9-493f-956b-db5384ef2fb4"],
 " ,\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["z", "*"], "/", 
    SubscriptBox["z", "h"]}], TraditionalForm]],ExpressionUUID->
  "7ba03e21-b120-4842-a296-3313f3d9edb7"],
 " can be expressed as a function of ",
 Cell[BoxData[
  FormBox[
   RowBox[{"l", "/", 
    SubscriptBox["z", "h"]}], TraditionalForm]],ExpressionUUID->
  "67cf6c17-64f0-409a-86ca-0ba61519ed94"],
 ", as we\[CloseCurlyQuote]ll now show explicitly."
}], "Text",ExpressionUUID->"dfb92b9f-318a-4486-8653-9a3249466793"],

Cell[TextData[{
 "These formulas give the regularized entropies/areas which are used for \
comparing local minima.\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"4", 
      SubscriptBox["G", "N"], 
      SuperscriptBox[
       SubscriptBox["z", "h"], "2"], "S"}], 
     RowBox[{
      SuperscriptBox["R", "3"], "V"}]], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["S", "0"], "(", 
      FractionBox[
       SubscriptBox["z", "*"], 
       SubscriptBox["z", "h"]], ")"}], "+", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], "N"], 
      RowBox[{
       SubscriptBox["a", "i"], "(", 
       RowBox[{
        RowBox[{
         SubscriptBox["S", "i"], "(", 
         FractionBox[
          SubscriptBox["z", "*"], 
          SubscriptBox["z", "h"]], ")"}], "-", 
        RowBox[{
         SubscriptBox["S", 
          RowBox[{"N", "+", "1"}]], "(", 
         FractionBox[
          SubscriptBox["z", "*"], 
          SubscriptBox["z", "h"]], ")"}]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"87054988-d5bd-4f9e-a003-16e5415ed8de"],
 " ,\nwhere\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["S", "0"], "(", 
     FractionBox[
      SubscriptBox["z", "*"], 
      SubscriptBox["z", "h"]], ")"}], "=", 
    RowBox[{
     FractionBox[
      SuperscriptBox[
       SubscriptBox["z", "h"], "2"], 
      SuperscriptBox["\[Epsilon]", "2"]], "-", 
     FractionBox[
      SuperscriptBox[
       SubscriptBox["z", "h"], "2"], 
      SuperscriptBox[
       SubscriptBox["z", "*"], "2"]], "+", 
     RowBox[{"2", 
      FractionBox[
       SuperscriptBox[
        SubscriptBox["z", "h"], "2"], 
       SuperscriptBox[
        SubscriptBox["z", "*"], "2"]], 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "1"], 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["y", "3"]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", 
            SqrtBox[
             RowBox[{"b", "(", 
              RowBox[{"y", " ", 
               SubscriptBox["z", "*"]}], ")"}]]], 
           FractionBox["1", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["y", "6"]}]]]}], "-", "1"}], ")"}], 
        RowBox[{"\[DifferentialD]", "y"}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["S", "1"], "(", 
     FractionBox[
      SubscriptBox["z", "*"], 
      SubscriptBox["z", "h"]], ")"}], "=", 
    RowBox[{
     RowBox[{"2", 
      FractionBox[
       SubscriptBox["z", "h"], "\[Epsilon]"]}], "-", 
     RowBox[{"2", 
      FractionBox[
       SubscriptBox["z", "h"], 
       SubscriptBox["z", "*"]]}], "+", 
     RowBox[{"2", 
      FractionBox[
       SubscriptBox["z", "h"], 
       SubscriptBox["z", "*"]], 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "1"], 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["y", "2"]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", 
            SqrtBox[
             RowBox[{"b", "(", 
              RowBox[{"y", " ", 
               SubscriptBox["z", "*"]}], ")"}]]], 
           FractionBox["1", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["y", "6"]}]]]}], "-", "1"}], ")"}], 
        RowBox[{"\[DifferentialD]", "y"}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["S", "2"], "(", 
     FractionBox[
      SubscriptBox["z", "*"], 
      SubscriptBox["z", "h"]], ")"}], "=", 
    RowBox[{
     RowBox[{
      FractionBox["2", 
       SuperscriptBox[
        SubscriptBox["z", "h"], "2"]], 
      RowBox[{"log", "(", 
       FractionBox[
        SubscriptBox["z", "h"], "\[Epsilon]"], ")"}]}], "+", 
     RowBox[{
      FractionBox["2", 
       SuperscriptBox[
        SubscriptBox["z", "h"], "2"]], 
      RowBox[{"log", "(", 
       FractionBox[
        SubscriptBox["z", "*"], 
        SubscriptBox["z", "h"]], ")"}]}], "+", 
     RowBox[{"2", 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "1"], 
       RowBox[{
        FractionBox["1", "y"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", 
            SqrtBox[
             RowBox[{"b", "(", 
              RowBox[{"y", " ", 
               SubscriptBox["z", "*"]}], ")"}]]], 
           FractionBox["1", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["y", "6"]}]]]}], "-", "1"}], ")"}], 
        RowBox[{"\[DifferentialD]", "y"}]}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["S", 
      RowBox[{"i", "\[GreaterEqual]", "3"}]], "(", 
     FractionBox[
      SubscriptBox["z", "*"], 
      SubscriptBox["z", "h"]], ")"}], "=", 
    RowBox[{"2", 
     FractionBox[
      SuperscriptBox[
       SubscriptBox["z", "*"], 
       RowBox[{"i", "-", "2"}]], 
      SuperscriptBox[
       SubscriptBox["z", "h"], 
       RowBox[{"i", "-", "2"}]]], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       FractionBox[
        SuperscriptBox["y", 
         RowBox[{"i", "-", "3"}]], 
        SqrtBox[
         RowBox[{"b", "(", 
          RowBox[{"y", " ", 
           SubscriptBox["z", "*"]}], ")"}]]], 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["y", "6"]}]]], 
       RowBox[{
        RowBox[{"\[DifferentialD]", "y"}], " ", "."}]}]}]}]}], 
   TraditionalForm]}],ExpressionUUID->"3430ccfe-69de-4d9c-a28a-070978023f08"]
}], "Text",ExpressionUUID->"e7f61f9c-3946-4821-91e7-44f29fce3e4e"],

Cell[TextData[{
 " Throughout this notebook, we\[CloseCurlyQuote]ll measure ",
 Cell[BoxData[
  FormBox["l", TraditionalForm]],ExpressionUUID->
  "da2ffb7c-f475-40d9-90b9-a78a2a32eced"],
 " and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "*"], TraditionalForm]],ExpressionUUID->
  "f78f1e9b-2bd2-4efc-a6dc-fa3a52865e3b"],
 " in units of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "h"], TraditionalForm]],ExpressionUUID->
  "261ec1ba-7691-4e78-8c29-ea6c724357ac"],
 ", effectively setting ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["z", "h"], "=", "1"}], TraditionalForm]],ExpressionUUID->
  "fedaf9c2-169f-4d27-814d-0709b0cb58cf"],
 " ."
}], "Text",ExpressionUUID->"31365504-c916-43ca-8acc-2e8cb90ccdde"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"b", "[", "z_", "]"}], ":=", 
  RowBox[{"1", "-", 
   SuperscriptBox["z", "4"]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetOptions", "[", 
   RowBox[{"NIntegrate", ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"PrecisionGoal", "\[Rule]", "10"}], ",", 
      RowBox[{"MinRecursion", "\[Rule]", "3"}], ",", 
      RowBox[{"MaxRecursion", "\[Rule]", "20"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "[", 
   RowBox[{"0", ",", "zs_Real"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", 
     SuperscriptBox["zs", "2"]]}], "+", 
   RowBox[{
    FractionBox["2", 
     SuperscriptBox["zs", "2"]], 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["y", "3"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           SqrtBox[
            RowBox[{"b", "[", 
             RowBox[{"zs", " ", "y"}], "]"}]]], 
          FractionBox["1", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["y", "6"]}]]]}], "-", "1"}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "[", 
   RowBox[{"1", ",", "zs_Real"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"-", 
    FractionBox["2", "zs"]}], "+", 
   RowBox[{
    FractionBox["2", "zs"], 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["y", "2"]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           SqrtBox[
            RowBox[{"b", "[", 
             RowBox[{"zs", " ", "y"}], "]"}]]], 
          FractionBox["1", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["y", "6"]}]]]}], "-", "1"}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "[", 
   RowBox[{"2", ",", "zs_Real"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"2", 
    RowBox[{"Log", "[", "zs", "]"}]}], "+", 
   RowBox[{"2", 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", "y"], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           SqrtBox[
            RowBox[{"b", "[", 
             RowBox[{"zs", " ", "y"}], "]"}]]], 
          FractionBox["1", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox["y", "6"]}]]]}], "-", "1"}], ")"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], 
     "]"}]}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "[", 
   RowBox[{"i_Integer", ",", "zs_Real"}], "]"}], ":=", 
  RowBox[{"2", 
   SuperscriptBox["zs", 
    RowBox[{"i", "-", "2"}]], 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      FractionBox[
       SuperscriptBox["y", 
        RowBox[{"i", "-", "3"}]], 
       SqrtBox[
        RowBox[{"b", "[", 
         RowBox[{"zs", " ", "y"}], "]"}]]], 
      FractionBox["1", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["y", "6"]}]]]}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"S", "[", 
   RowBox[{"as_List", ",", "zs_Real"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"S", "[", 
    RowBox[{"0", ",", "zs"}], "]"}], "+", 
   RowBox[{"Sum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"as", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
      RowBox[{"S", "[", 
       RowBox[{"i", ",", "zs"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", 
       RowBox[{"Length", "[", "as", "]"}]}], "}"}]}], "]"}]}]}]}], "Input",
 CellLabel->"In[1]:=",ExpressionUUID->"83a40a8d-3f23-4e5b-8497-20521f91323d"],

Cell[TextData[{
 "We rewrite the width integral as\n",
 Cell[BoxData[
  FormBox[
   RowBox[{"l", "=", 
    RowBox[{"2", 
     SubscriptBox["z", "*"], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       SuperscriptBox["y", "3"], 
       FractionBox[
        RowBox[{"a", "(", 
         RowBox[{"y", " ", 
          SubscriptBox["z", "*"]}], ")"}], 
        SqrtBox[
         RowBox[{"b", "(", 
          RowBox[{"y", " ", 
           SubscriptBox["z", "*"]}], ")"}]]], 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["y", "6"]}]]], 
       RowBox[{"\[DifferentialD]", "y"}]}]}]}]}], TraditionalForm]],
  ExpressionUUID->"f2f22c65-b790-46eb-8f1c-7e69ed072934"],
 " .\nNow the advantage of choosing the blackening factor as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox[
     RowBox[{"a", "(", "z", ")"}], "2"], "/", 
    RowBox[{"b", "(", "z", ")"}]}], TraditionalForm]],ExpressionUUID->
  "7eb21b40-23b9-4fcf-bb8e-b2a49d95df9b"],
 " is clear: the width integral splits to a sum of integrals\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox["l", 
     SubscriptBox["z", "h"]], "=", 
    RowBox[{
     RowBox[{
      SubscriptBox["l", "0"], "(", 
      FractionBox[
       SubscriptBox["z", "*"], 
       SubscriptBox["z", "h"]], ")"}], "+", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], "N"], 
      RowBox[{
       SubscriptBox["a", "i"], "(", 
       RowBox[{
        RowBox[{
         SubscriptBox["l", "i"], "(", 
         FractionBox[
          SubscriptBox["z", "*"], 
          SubscriptBox["z", "h"]], ")"}], "-", 
        RowBox[{
         SubscriptBox["l", 
          RowBox[{"N", "+", "1"}]], "(", 
         FractionBox[
          SubscriptBox["z", "*"], 
          SubscriptBox["z", "h"]], ")"}]}], ")"}]}]}]}], TraditionalForm]],
  ExpressionUUID->"8b8f42ae-bfe1-4303-b884-2ad94f74d6d7"],
 " ,\nwhere\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["l", "0"], "(", 
     FractionBox[
      SubscriptBox["z", "*"], 
      SubscriptBox["z", "h"]], ")"}], "=", 
    RowBox[{"2", 
     FractionBox[
      SubscriptBox["z", 
       RowBox[{"*", " "}]], 
      SubscriptBox["z", "h"]], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       SuperscriptBox["y", "3"], 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"b", "(", 
          RowBox[{"y", " ", 
           SubscriptBox["z", "*"]}], ")"}]]], 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["y", "6"]}]]], 
       RowBox[{"\[DifferentialD]", "y"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["l", "i"], "(", 
     FractionBox[
      SubscriptBox["z", "*"], 
      SubscriptBox["z", "h"]], ")"}], "=", 
    RowBox[{"2", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        SubscriptBox["z", "*"], 
        SubscriptBox["z", "h"]], ")"}], 
      RowBox[{"1", "+", "i"}]], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       FractionBox[
        SuperscriptBox["y", 
         RowBox[{"3", "+", "i"}]], 
        SqrtBox[
         RowBox[{"b", "(", 
          RowBox[{"y", " ", 
           SubscriptBox["z", "*"]}], ")"}]]], 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["y", "6"]}]]], 
       RowBox[{
        RowBox[{"\[DifferentialD]", "y"}], " ", "."}]}]}]}]}], 
   TraditionalForm]}],ExpressionUUID->
  "cc46076f-e14d-4262-b9db-e72a965d0534"],
 "\nThe first term gives the usual planar ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["AdS", "5"], "-", "BH"}], TraditionalForm]],ExpressionUUID->
  "9c872bf0-757b-48c1-9817-73d30a625c36"],
 " and all ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["a", "i"], TraditionalForm]],ExpressionUUID->
  "7e448c26-96fb-4943-9fce-325cb78b7929"],
 "-terms are perturbations on top of that."
}], "Text",ExpressionUUID->"86470fcd-0e48-4e8a-98fb-1a4332136add"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"l", "[", 
   RowBox[{"i_Integer", ",", "zs_Real"}], "]"}], ":=", 
  RowBox[{"2", 
   SuperscriptBox["zs", 
    RowBox[{"1", "+", "i"}]], " ", 
   RowBox[{"NIntegrate", "[", 
    RowBox[{
     RowBox[{
      FractionBox[
       SuperscriptBox["y", 
        RowBox[{"3", "+", "i"}]], 
       SqrtBox[
        RowBox[{"b", "[", 
         RowBox[{"zs", " ", "y"}], "]"}]]], 
      FractionBox["1", 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox["y", "6"]}]]]}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"l", "[", 
   RowBox[{"as_List", ",", "zs_Real"}], "]"}], ":=", 
  RowBox[{"With", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"N", "=", 
      RowBox[{"Length", "[", "as", "]"}]}], "}"}], ",", 
    RowBox[{"2", "zs", " ", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        SuperscriptBox["y", "3"], 
        FractionBox[
         RowBox[{"1", "+", 
          RowBox[{"Sum", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
             "as", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                SuperscriptBox["zs", "i"], 
                SuperscriptBox["y", "i"]}], "-", 
               RowBox[{
                SuperscriptBox["zs", 
                 RowBox[{"N", "+", "1"}]], 
                SuperscriptBox["y", 
                 RowBox[{"N", "+", "1"}]]}]}], ")"}]}], ",", 
            RowBox[{"{", 
             RowBox[{"i", ",", "N"}], "}"}]}], "]"}]}], 
         SqrtBox[
          RowBox[{"b", "[", 
           RowBox[{"zs", " ", "y"}], "]"}]]], 
        FractionBox["1", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["y", "6"]}]]]}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellLabel->"In[8]:=",ExpressionUUID->"7bfb20ed-9650-4b1a-9236-5668fb9ea9df"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Example: Perturbed ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["AdS", "5"], "-", "BH"}], TraditionalForm]],ExpressionUUID->
  "ec64fde7-233c-4df2-8507-ef3f97e82954"]
}], "Chapter",ExpressionUUID->"5acfee8b-7ba1-42f1-ac11-0d34a04a0541"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SetOptions", "[", 
     RowBox[{"#", ",", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Thick", ",", "Bold", ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Roman\>\""}]}], "}"}]}], ",", 
      RowBox[{"AxesStyle", "\[Rule]", "Thick"}], ",", 
      RowBox[{"LabelStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Black", ",", 
         RowBox[{"FontSize", "\[Rule]", "14"}], ",", 
         RowBox[{"FontFamily", "\[Rule]", "\"\<Latin Modern Roman\>\""}]}], 
        "}"}]}]}], "]"}], "&"}], "/@", 
   RowBox[{"{", 
    RowBox[{
    "Plot", ",", "LogPlot", ",", "ListPlot", ",", "ListLogPlot", ",", 
     "ListLinePlot"}], "}"}]}], ";"}]], "Input",
 CellLabel->"In[10]:=",ExpressionUUID->"10245dd2-1024-4708-8467-386f38d99d0e"],

Cell[CellGroupData[{

Cell["Generate data", "Section",ExpressionUUID->"7d171a86-9a43-4b60-aa0f-62949a6ea516"],

Cell["\<\
Let\[CloseCurlyQuote]s generate some synthetic data. Say, that we have \
measurements for 10 different widths.\
\>", "Text",ExpressionUUID->"be6e37e4-2a93-4ae5-abf0-f360f68efa6e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"Errorize", "[", "\[Delta]_Real", "]"}], ":=", 
  RowBox[{"Function", "[", 
   RowBox[{"true", ",", 
    RowBox[{"{", 
     RowBox[{"true", ",", 
      RowBox[{
       RowBox[{"RandomReal", "[", 
        RowBox[{"{", 
         RowBox[{"\[Delta]", ",", 
          RowBox[{"2", "\[Delta]"}]}], "}"}], "]"}], "true"}]}], "}"}]}], 
   "]"}]}]], "Input",
 CellLabel->"In[11]:=",ExpressionUUID->"3c0eb1af-217b-403b-b9b7-e50fa2a8c417"],

Cell[BoxData[
 RowBox[{
  RowBox[{"GeneratezsData", "[", 
   RowBox[{
   "as_List", ",", "Ndata_Integer", ",", "lmin_Real", ",", "lmax_Real"}], 
   "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "zsf", "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"zsf", "=", 
      RowBox[{"Interpolation", "[", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"l", "[", 
             RowBox[{"as", ",", "zs"}], "]"}], ",", "zs"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"zs", ",", 
            RowBox[{"Range", "[", 
             RowBox[{"0.01", ",", "0.999", ",", "0.001"}], "]"}]}], "}"}]}], 
         "]"}], ",", 
        RowBox[{"InterpolationOrder", "\[Rule]", "1"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"zsf", "[", "l", "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"l", ",", 
         RowBox[{"Range", "[", 
          RowBox[{"lmin", ",", "lmax", ",", 
           FractionBox[
            RowBox[{"lmax", "-", "lmin"}], 
            RowBox[{"Ndata", "-", "1"}]]}], "]"}]}], "}"}]}], "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellLabel->"In[12]:=",ExpressionUUID->"44f56192-94ff-4a06-ba99-002abf03b6e5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Ndata", "=", "10"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aData", "=", 
   RowBox[{"{", 
    RowBox[{"1", ",", 
     RowBox[{"-", "0.5"}], ",", 
     RowBox[{"-", "0.5"}], ",", "0.25"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Nbasis", "=", 
   RowBox[{"Length", "[", "aData", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"zsData", "=", 
   RowBox[{"GeneratezsData", "[", 
    RowBox[{"aData", ",", "Ndata", ",", "0.1", ",", "2.2"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lData", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"l", "[", 
      RowBox[{"aData", ",", "#"}], "]"}], "&"}], "/@", "zsData"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"scaleData", "=", "15.0"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   FractionBox[
    SuperscriptBox["R", "3"], 
    RowBox[{"4", " ", 
     SubscriptBox["G", "N"]}]], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"SData", ",", "\[Sigma]Data"}], "}"}], "=", 
   RowBox[{"Transpose", "[", 
    RowBox[{
     RowBox[{"Errorize", "[", "0.1", "]"}], "/@", 
     FractionBox["scaleData", 
      SuperscriptBox["zsData", "3"]]}], "]"}]}], ";"}]}], "Input",
 CellLabel->"In[13]:=",ExpressionUUID->"03b5ccc2-83fd-4f66-a75e-a7a24f4b0e18"],

Cell["\<\
Visually, the test data looks like (error bars represent the 95% CCI)\
\>", "Text",ExpressionUUID->"b2e7ef38-686e-4564-815e-70c7c1eb241a"],

Cell[BoxData[{
 RowBox[{"Quantile", "[", 
  RowBox[{
   RowBox[{"NormalDistribution", "[", 
    RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}], ",", "0.025"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Quantile", "[", 
  RowBox[{
   RowBox[{"NormalDistribution", "[", 
    RowBox[{"\[Mu]", ",", "\[Sigma]"}], "]"}], ",", "0.975"}], 
  "]"}]}], "Input",
 CellLabel->"In[19]:=",ExpressionUUID->"e9c211bc-3898-4a37-9e0f-3fa07bd00f5e"],

Cell[BoxData[
 RowBox[{"dataPlot", "=", 
  RowBox[{"ListLogPlot", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
           ",", 
          RowBox[{"Around", "[", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "2", "\[RightDoubleBracket]"}], ",", 
            
            RowBox[{"1.9599639845400547`", 
             RowBox[{
             "#", "\[LeftDoubleBracket]", "3", "\[RightDoubleBracket]"}]}]}], 
           "]"}]}], "}"}], "&"}], "/@", 
       RowBox[{"Thread", "[", 
        RowBox[{"{", 
         RowBox[{"lData", ",", "SData", ",", "\[Sigma]Data"}], "}"}], "]"}]}],
       ",", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"l", "[", 
           RowBox[{"aData", ",", "zs"}], "]"}], ",", 
          FractionBox["scaleData", 
           SuperscriptBox["zs", "3"]]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"zs", ",", 
          RowBox[{"Range", "[", 
           RowBox[{"0.1", ",", "0.992", ",", 
            FractionBox[
             RowBox[{"0.992", "-", "0.1"}], "20"]}], "]"}]}], "}"}]}], 
       "]"}]}], "}"}], ",", 
    RowBox[{"Joined", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"False", ",", "True"}], "}"}]}], ",", 
    RowBox[{"PlotStyle", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{"Black", ",", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Dashed"}], "}"}]}], "}"}]}], ",", 
    RowBox[{"AxesLabel", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
      "\"\<\!\(\*FractionBox[\(\[ScriptL]\), SubscriptBox[\(z\), \
\(h\)]]\)\>\"", ",", 
       RowBox[{"Row", "[", 
        RowBox[{"{", 
         RowBox[{
         "\"\<\!\(\*FractionBox[SuperscriptBox[SubscriptBox[\(z\), \(h\)], \
\(3\)], \(\(|\)\(\[PartialD]A\)\(|\)\)]\)\>\"", ",", 
          
          FractionBox["\"\<d \!\(\*SubscriptBox[\(S\), \(A\)]\)\>\"", 
           "\"\<d \[ScriptL]\>\""]}], "}"}], "]"}]}], "}"}]}], ",", 
    RowBox[{"PlotRange", "\[Rule]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "Automatic"}], "}"}], ",", "All"}], "}"}]}]}], 
   "]"}]}]], "Input",
 CellLabel->"In[21]:=",ExpressionUUID->"959ee65d-4157-4390-8538-9fe92c22745a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Load MathematicaStan", "Section",ExpressionUUID->"f077fcc6-16d6-4957-8821-dd5892447070"],

Cell[TextData[{
 "To run this you need to clone ",
 StyleBox["cmdstan", "CodeText"],
 " and ",
 StyleBox["MathematicaStan", "CodeText"],
 " from Github. For ",
 StyleBox["cmdstan", "CodeText"],
 ", follow the instructions at\n",
 StyleBox["https://github.com/stan-dev/cmdstan/wiki/Getting-Started-with-\
CmdStan",
  FontWeight->"Bold"]
}], "Text",ExpressionUUID->"56f71cc3-8529-4471-ae74-8c70d7f90208"],

Cell[TextData[{
 "Load ",
 StyleBox["MathematicaStan", "CodeText"],
 " and point it to the ",
 StyleBox["cmdstan", "CodeText"],
 " directory. This assumes that you cloned the repos in notebook directory."
}], "Text",ExpressionUUID->"6c339785-5643-44cc-987c-4e852332c71a"],

Cell[BoxData[{
 RowBox[{"Get", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
   "\"\<MathematicaStan/CmdStan.m\>\""}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SetCmdStanDirectory", "[", 
   RowBox[{
    RowBox[{"NotebookDirectory", "[", "]"}], "<>", "\"\<cmdstan\>\""}], "]"}],
   ";"}], "\[IndentingNewLine]", 
 RowBox[{"Get", "[", 
  RowBox[{
   RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
   "\"\<MathematicaStan/CmdStan.m\>\""}], "]"}]}], "Input",
 CellLabel->"In[22]:=",ExpressionUUID->"3c799f99-ad23-40ce-8df4-fe68bb4ea1d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Obtain a point estimate (MLE)", "Section",ExpressionUUID->"9d4b6bc3-bb89-4b2e-9065-81406692722c"],

Cell["Compile the sampler.", "Text",ExpressionUUID->"f30d86c8-b366-497e-8059-def72e70335a"],

Cell[BoxData[
 RowBox[{"stanProgram", "=", 
  RowBox[{"CompileStanCode", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<hee_sampler.stan\>\""}], ",", 
    RowBox[{"StanVerbose", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellLabel->"In[25]:=",ExpressionUUID->"bc4cdc16-d12a-4080-a051-c01a302f2364"],

Cell[TextData[{
 "Prepare the data file for the sampler, without priors (",
 StyleBox["\[CloseCurlyDoubleQuote]use_prior\[CloseCurlyDoubleQuote]\[Rule]0",
   "CodeText"],
 ")."
}], "Text",ExpressionUUID->"1f03f9ab-dcd6-48c3-9831-bb093ac5309a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stanData", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<N_data\>\"", "\[Rule]", "Ndata"}], ",", 
     RowBox[{"\"\<N_basis\>\"", "\[Rule]", "Nbasis"}], ",", 
     RowBox[{"\"\<l\>\"", "\[Rule]", "lData"}], ",", 
     RowBox[{"\"\<dS_dl\>\"", "\[Rule]", "SData"}], ",", 
     RowBox[{"\"\<sigma\>\"", "\[Rule]", "\[Sigma]Data"}], ",", 
     RowBox[{"\"\<a_prior_mean\>\"", "\[Rule]", "aData"}], ",", 
     RowBox[{"\"\<scale_prior_mean\>\"", "\[Rule]", "1.0"}], ",", 
     RowBox[{"\"\<use_prior\>\"", "\[Rule]", "0"}]}], "|>"}]}], ";"}], "\n", 
 RowBox[{"stanDataFile", "=", 
  RowBox[{"ExportStanData", "[", 
   RowBox[{"stanProgram", ",", "stanData"}], "]"}]}]}], "Input",
 CellLabel->"In[26]:=",ExpressionUUID->"cc1d0b8d-f4be-47ad-81af-3643fccd61c8"],

Cell[TextData[{
 "Set initial values for ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "cd422456-bd9d-47c3-9e39-bfd75026c9b1"],
 ". The sampler uses a QR-decomposition, so the variables actually sampled \
are ",
 Cell[BoxData[
  FormBox[
   RowBox[{"b", "=", 
    RowBox[{"R", "\[CenterDot]", "a"}]}], TraditionalForm]],ExpressionUUID->
  "e4f1488b-09ca-403a-98fb-d2af910ec4c2"],
 ", for a matrix ",
 Cell[BoxData[
  FormBox["R", TraditionalForm]],ExpressionUUID->
  "b2e5f34b-fca7-48b2-8912-a4fbe88d861e"],
 ". We\[CloseCurlyQuote]ll start the sampling at ",
 Cell[BoxData[
  FormBox[
   RowBox[{"a", "=", 
    RowBox[{"b", "=", "0"}]}], TraditionalForm]],ExpressionUUID->
  "90f4cc2e-2033-4296-9429-05070653a14a"],
 "."
}], "Text",ExpressionUUID->"d10954bf-5166-47ff-8a1e-cc00d0504b65"],

Cell[BoxData[{
 RowBox[{"stanInits", "=", 
  RowBox[{"<|", 
   RowBox[{
    RowBox[{"\"\<b\>\"", "\[Rule]", 
     RowBox[{"Table", "[", 
      RowBox[{"0.0", ",", "Nbasis"}], "]"}]}], ",", 
    RowBox[{"\"\<scale\>\"", "\[Rule]", "10.0"}]}], 
   "|>"}]}], "\[IndentingNewLine]", 
 RowBox[{"stanInitsFile", "=", 
  RowBox[{"ExportStanData", "[", 
   RowBox[{
    RowBox[{"stanProgram", "<>", "\"\<_inits\>\""}], ",", "stanInits"}], 
   "]"}]}]}], "Input",
 CellLabel->"In[28]:=",ExpressionUUID->"a43c91eb-3a83-4019-a999-ff0a687f6198"],

Cell["Set runtime options for the optimizer.", "Text",ExpressionUUID->"5be2dbb0-a5d9-48d3-a964-df69f0d284ab"],

Cell[BoxData[
 RowBox[{
  RowBox[{"SetStanOptions", "[", 
   RowBox[{"opts_Association", ",", 
    RowBox[{"default_", ":", "SampleDefaultOptions"}]}], "]"}], ":=", 
  RowBox[{"Fold", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"SetStanOption", "[", 
      RowBox[{"#1", ",", "#2", ",", 
       RowBox[{"opts", "[", "#2", "]"}]}], "]"}], "&"}], ",", "default", ",", 
    
    RowBox[{"Keys", "[", "opts", "]"}]}], "]"}]}]], "Input",
 CellLabel->"In[30]:=",ExpressionUUID->"e8079a24-28a6-4bd3-8ea1-ce5dae8530ed"],

Cell[BoxData[
 RowBox[{"opt", "=", 
  RowBox[{"SetStanOptions", "[", 
   RowBox[{
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<method.algorithm\>\"", "\[Rule]", "\"\<lbfgs\>\""}], ",", 
      RowBox[{"\"\<random.seed\>\"", "\[Rule]", "255816225"}], ",", 
      RowBox[{"\"\<init\>\"", "\[Rule]", "stanInitsFile"}]}], "|>"}], ",", 
    "OptimizeDefaultOptions"}], "]"}]}]], "Input",
 CellLabel->"In[31]:=",ExpressionUUID->"4a1a0e20-6172-4239-b718-4eea9e39710d"],

Cell["Run the optimizer.", "Text",ExpressionUUID->"2c1a7821-53bd-403b-bf87-460f50af0ae8"],

Cell[BoxData[
 RowBox[{"stanResultFile", "=", 
  RowBox[{"RunStan", "[", 
   RowBox[{"stanProgram", ",", "opt"}], "]"}]}]], "Input",
 CellLabel->"In[32]:=",ExpressionUUID->"a293c52a-d95a-4d77-8068-09136524ea08"],

Cell["Read the results.", "Text",ExpressionUUID->"46dbea91-9164-477e-a1c3-ccc033c47501"],

Cell[BoxData[{
 RowBox[{"stanResult", "=", 
  RowBox[{
  "ImportStanResult", "[", "stanResultFile", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"asMLE", "=", 
  RowBox[{"Flatten", "@", 
   RowBox[{"GetStanResult", "[", 
    RowBox[{"stanResult", ",", "\"\<a\>\""}], 
    "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"scaleMLE", "=", 
  RowBox[{"First", "@", 
   RowBox[{"GetStanResult", "[", 
    RowBox[{"stanResult", ",", "\"\<scale\>\""}], "]"}]}]}]}], "Input",
 CellLabel->"In[33]:=",ExpressionUUID->"3e3301cb-201c-4b6a-ba9c-f8a1eba7e5fa"],

Cell["\<\
The MLE is very close to the actual parameters we used to generate the data.\
\>", "Text",ExpressionUUID->"688ff7d6-62ca-4cfd-beea-8470d7d9071d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Run the HMC sampler", "Section",ExpressionUUID->"84c96554-0430-4533-9957-464c26c875db"],

Cell[TextData[{
 "Set runtime options and run the sampler. I actually prefer to run this part \
from the command line because the sampling takes quite a long time in this \
version where we use on-line integration. To run the sampler from the command \
line, you would do something like\n",
 StyleBox["./hee-sampler method=sample num_warmup=1000 num_samples=1000 \
output file=hee_sampler.csv init=hee-sampler_inits.data.R data \
file=hee_sampler.data.R\n", "CodeText"],
 "but in the notebook it would be"
}], "Text",ExpressionUUID->"c0319981-4861-4d56-b0a8-4a52206fa427"],

Cell[BoxData[
 RowBox[{"stanProgram", "=", 
  RowBox[{"CompileStanCode", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"NotebookDirectory", "[", "]"}], "<>", 
     "\"\<hee_sampler.stan\>\""}], ",", 
    RowBox[{"StanVerbose", "\[Rule]", "False"}]}], "]"}]}]], "Input",
 CellLabel->"In[36]:=",ExpressionUUID->"2f51ecd3-eb50-4dd0-bccd-0acb58b08e50"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"stanData", "=", 
   RowBox[{"<|", 
    RowBox[{
     RowBox[{"\"\<N_data\>\"", "\[Rule]", "Ndata"}], ",", 
     RowBox[{"\"\<N_basis\>\"", "\[Rule]", "Nbasis"}], ",", 
     RowBox[{"\"\<l\>\"", "\[Rule]", "lData"}], ",", 
     RowBox[{"\"\<dS_dl\>\"", "\[Rule]", "SData"}], ",", 
     RowBox[{"\"\<sigma\>\"", "\[Rule]", "\[Sigma]Data"}], ",", 
     RowBox[{"\"\<a_prior_mean\>\"", "\[Rule]", 
      RowBox[{"Take", "[", 
       RowBox[{"asMLE", ",", "Nbasis"}], "]"}]}], ",", 
     RowBox[{"\"\<scale_prior_mean\>\"", "\[Rule]", "scaleMLE"}], ",", 
     RowBox[{"\"\<use_prior\>\"", "\[Rule]", "1"}]}], "|>"}]}], ";"}], "\n", 
 RowBox[{"stanDataFile", "=", 
  RowBox[{"ExportStanData", "[", 
   RowBox[{"stanProgram", ",", "stanData"}], "]"}]}]}], "Input",
 CellLabel->"In[37]:=",ExpressionUUID->"9e351d5f-56ac-4b78-a8d9-596ed09c0198"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"iters", "=", "100"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"opt", "=", 
   RowBox[{"SetStanOptions", "[", 
    RowBox[{"<|", 
     RowBox[{
      RowBox[{"\"\<method.num_warmup\>\"", "\[Rule]", "iters"}], ",", 
      RowBox[{"\"\<method.num_samples\>\"", "\[Rule]", "iters"}], ",", 
      RowBox[{"\"\<output.refresh\>\"", "\[Rule]", "1"}], ",", 
      RowBox[{"\"\<init\>\"", "\[Rule]", "stanInitsFile"}]}], "|>"}], "]"}]}],
   ";"}], "\n", 
 RowBox[{"stanResultFile", "=", 
  RowBox[{"RunStanSample", "[", 
   RowBox[{"stanProgram", ",", "opt", ",", 
    RowBox[{"ShowProgress", "\[Rule]", "True"}], ",", 
    RowBox[{"Chains", "\[Rule]", "1"}]}], "]"}]}]}], "Input",
 CellLabel->"In[39]:=",ExpressionUUID->"b3f0f47e-f6f2-4507-93c4-c79773578817"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Analyze the results", "Section",ExpressionUUID->"cf2ea9b1-ec1e-46b0-acce-f15baf1f7ee8"],

Cell["Load the data", "Text",ExpressionUUID->"79181ae7-4f88-45ec-b92a-7f33a929d1b8"],

Cell[BoxData[
 RowBox[{"stanResult", "=", 
  RowBox[{"ImportStanResult", "[", "stanResultFile", "]"}]}]], "Input",
 CellLabel->"In[43]:=",ExpressionUUID->"3475b7cb-80fd-4e35-8549-6142ab0667ea"],

Cell[BoxData[
 RowBox[{"stanResult", "=", 
  RowBox[{
  "ImportStanResult", "[", 
   "\"\</wrk/bulkreco/finite_T_sampler/model/hee_sampler.csv\>\"", 
   "]"}]}]], "Input",
 CellLabel->"In[26]:=",ExpressionUUID->"27a53867-5a22-454e-ab40-4043feebc860"],

Cell[BoxData[
 RowBox[{"stanResult", "=", 
  RowBox[{"ImportStanResult", "@", 
   RowBox[{"Array", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"\"\</wrk/bulkreco/finite_T_sampler/model/hee_sampler_\>\"", "<>", 
       RowBox[{"ToString", "[", "#", "]"}], "<>", "\"\<.csv\>\""}], "&"}], 
     ",", "4"}], "]"}]}]}]], "Input",
 CellLabel->"In[42]:=",ExpressionUUID->"f12e18d9-c901-45b6-b7cf-7cfa8cbda7c2"],

Cell[CellGroupData[{

Cell["Helper functions", "Subsection",ExpressionUUID->"d08b964f-de97-4f71-8958-5b1cced54785"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Plotzs", "[", 
    RowBox[{"stanResult_StanResult", ",", 
     RowBox[{"zsTrue_", ":", "Null"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zsSamples", ",", "quantiles", ",", "plot"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zsSamples", "=", 
       RowBox[{"GetStanResult", "[", 
        RowBox[{"stanResult", ",", "\"\<zs\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"quantiles", "=", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Quantile", "[", 
           RowBox[{"#", ",", 
            RowBox[{"{", 
             RowBox[{
             "0.025", ",", "0.25", ",", "0.5", ",", "0.75", ",", "0.975"}], 
             "}"}]}], "]"}], "&"}], "/@", "zsSamples"}], "//", 
        "Transpose"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{"quantiles", ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "LightGray", ",", "Gray", ",", "Black", ",", "Gray", ",", 
            "LightGray"}], "}"}]}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<i\>\"", ",", 
            "\"\<\!\(\*SubscriptBox[\(z\), \(*\)]\)/\!\(\*SubscriptBox[\(z\), \
\(h\)]\)\>\""}], "}"}]}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"zsTrue", "=!=", "Null"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{"plot", ",", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"zsTrue", ",", 
            RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], "]"}], ",", 
        "plot"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gzz", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "z"}], "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"as", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"a", ",", 
           RowBox[{"-", 
            RowBox[{"Total", "[", "a", "]"}]}]}], "]"}]}], "}"}], ",", 
       FractionBox[
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
              "as", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              SuperscriptBox["z", "i"]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "as", "]"}]}], "}"}]}], "]"}]}], ")"}], 
         "2"], 
        RowBox[{"1", "-", 
         SuperscriptBox["z", "4"]}]]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gzzp", "=", 
   RowBox[{"Function", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"a", ",", "z"}], "}"}], ",", 
     RowBox[{"With", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"as", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"a", ",", 
           RowBox[{"-", 
            RowBox[{"Total", "[", "a", "]"}]}]}], "]"}]}], "}"}], ",", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"Sum", "[", 
              RowBox[{
               RowBox[{
                RowBox[{
                "as", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
                
                SuperscriptBox["z", "i"]}], ",", 
               RowBox[{"{", 
                RowBox[{"i", ",", 
                 RowBox[{"Length", "[", "as", "]"}]}], "}"}]}], "]"}]}], 
            ")"}], 
           RowBox[{"Sum", "[", 
            RowBox[{
             RowBox[{"i", " ", 
              RowBox[{
              "as", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
              SuperscriptBox["z", 
               RowBox[{"i", "-", "1"}]]}], ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", 
               RowBox[{"Length", "[", "as", "]"}]}], "}"}]}], "]"}]}], "+", 
          RowBox[{"4", 
           SuperscriptBox["z", "3"], 
           RowBox[{
            FractionBox["1", 
             RowBox[{"1", "-", 
              SuperscriptBox["z", "4"]}]], 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"Sum", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{
                  "as", "\[LeftDoubleBracket]", "i", 
                   "\[RightDoubleBracket]"}], 
                  SuperscriptBox["z", "i"]}], ",", 
                 RowBox[{"{", 
                  RowBox[{"i", ",", 
                   RowBox[{"Length", "[", "as", "]"}]}], "}"}]}], "]"}]}], 
              ")"}], "2"]}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["z", "4"]}], ")"}]}]}], "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"PlotMetric", "[", 
    RowBox[{"stanResult_StanResult", ",", 
     RowBox[{"aTrue_", ":", "Null"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"aSamples", ",", "zGrid", ",", "quantiles", ",", "plot"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"aSamples", "=", 
       RowBox[{"GetStanResult", "[", 
        RowBox[{"stanResult", ",", "\"\<a\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zGrid", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"0.01", ",", "0.99", ",", "0.02"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"quantiles", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"Quantile", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"gzz", "[", 
              RowBox[{"#", ",", "z"}], "]"}], "&"}], "/@", 
            RowBox[{"Transpose", "[", "aSamples", "]"}]}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0.025", ",", "0.25", ",", "0.5", ",", "0.75", ",", "0.975"}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"{", 
          RowBox[{"z", ",", "zGrid"}], "}"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"quantiles", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"zGrid", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
        RowBox[{"Transpose", "[", "quantiles", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{"quantiles", ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "LightGray", ",", "Gray", ",", "Black", ",", "Gray", ",", 
            "LightGray"}], "}"}]}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\!\(\*FractionBox[\(z\), SubscriptBox[\(z\), \(h\)]]\)\>\"", 
            ",", "\"\<\!\(\*SubscriptBox[\(g\), \(z\\\ z\)]\)\>\""}], "}"}]}],
          ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"All", ",", 
            RowBox[{"{", 
             RowBox[{"0", ",", "10"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"aTrue", "=!=", "Null"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{"plot", ",", 
          RowBox[{"Plot", "[", 
           RowBox[{
            RowBox[{"gzz", "[", 
             RowBox[{"aTrue", ",", "z"}], "]"}], ",", 
            RowBox[{"{", 
             RowBox[{"z", ",", "0", ",", "1"}], "}"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Thick", ",", "Red", ",", "Dashed"}], "}"}]}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"All", ",", 
               RowBox[{"{", 
                RowBox[{"0", ",", "10"}], "}"}]}], "}"}]}]}], "]"}]}], "]"}], 
        ",", "plot"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"LogPlotEntropy", "[", 
    RowBox[{"stanResult_StanResult", ",", 
     RowBox[{"dSdlTrue_", ":", "Null"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "zsSamples", ",", "scaleSamples", ",", "zGrid", ",", "quantiles", ",", 
       "plot"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zsSamples", "=", 
       RowBox[{"GetStanResult", "[", 
        RowBox[{"stanResult", ",", "\"\<zs\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"scaleSamples", "=", 
       RowBox[{"GetStanResult", "[", 
        RowBox[{"stanResult", ",", "\"\<scale\>\""}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"zGrid", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"0.01", ",", "0.99", ",", "0.02"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"quantiles", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Quantile", "[", 
          RowBox[{
           RowBox[{"scaleSamples", "#"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "0.025", ",", "0.25", ",", "0.5", ",", "0.75", ",", "0.975"}], 
            "}"}]}], "]"}], "&"}], "/@", 
        FractionBox["1", 
         SuperscriptBox["zsSamples", "3"]]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"quantiles", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Thread", "[", 
          RowBox[{"{", 
           RowBox[{"lData", ",", "#"}], "}"}], "]"}], "&"}], "/@", 
        RowBox[{"Transpose", "[", "quantiles", "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"ListLogPlot", "[", 
        RowBox[{"quantiles", ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "LightGray", ",", "Gray", ",", "Black", ",", "Gray", ",", 
            "LightGray"}], "}"}]}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\!\(\*FractionBox[\(\[ScriptL]\), SubscriptBox[\(z\), \(h\)]]\
\)\>\"", ",", 
            "\"\<\!\(\*FractionBox[SuperscriptBox[SubscriptBox[\(z\), \(h\)], \
\(3\)], \(\(|\)\(\[PartialD]A\)\(|\)\)]\)\!\(\*FractionBox[\(d\\\ \
\*SubscriptBox[\(S\), \(A\)]\), \(d\\\ \[ScriptL]\)]\)\>\""}], "}"}]}]}], 
        "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"dSdlTrue", "=!=", "Null"}], ",", 
        RowBox[{"Show", "[", 
         RowBox[{"plot", ",", 
          RowBox[{"ListLogPlot", "[", 
           RowBox[{
            RowBox[{"Thread", "[", 
             RowBox[{"{", 
              RowBox[{"lData", ",", "dSdlTrue"}], "}"}], "]"}], ",", 
            RowBox[{"PlotStyle", "\[Rule]", "Red"}]}], "]"}]}], "]"}], ",", 
        "plot"}], "]"}]}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"TracePlots", "[", 
    RowBox[{"stanResult_StanResult", ",", "var_String"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"traces", ",", "traceLength", ",", "thinning", ",", "plots"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"traces", "=", 
       RowBox[{"GetStanResult", "[", 
        RowBox[{"stanResult", ",", "var"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"traceLength", "=", 
       RowBox[{"Length", "@", 
        RowBox[{"First", "@", "traces"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"thinning", "=", 
       RowBox[{"Floor", "[", 
        RowBox[{"traceLength", "/", "500"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Apply", " ", "thinning"}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"traces", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"#", "\[LeftDoubleBracket]", 
          RowBox[{";;", ";;", "thinning"}], "\[RightDoubleBracket]"}], "&"}], 
        "/@", "traces"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"plots", "=", 
       RowBox[{
        RowBox[{"MapIndexed", "[", 
         RowBox[{
          RowBox[{"ListLinePlot", "[", 
           RowBox[{"#1", ",", 
            RowBox[{"PlotLabel", "\[Rule]", "#2"}]}], "]"}], "&"}], "]"}], 
        "@", "traces"}]}], ";", "\[IndentingNewLine]", "plots"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ScatterPlots", "[", 
    RowBox[{"stanResult_StanResult", ",", "var_String", ",", 
     RowBox[{"asTrue_List", ":", "Null"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"samples", ",", "thinning", ",", "pairs", ",", "plots"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"samples", "=", 
       RowBox[{"GetStanResult", "[", 
        RowBox[{"stanResult", ",", "var"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"samples", "=", 
       RowBox[{"Transpose", "@", 
        RowBox[{"RandomSample", "[", 
         RowBox[{
          RowBox[{"Transpose", "@", "samples"}], ",", 
          RowBox[{"Min", "[", 
           RowBox[{"1000", ",", 
            RowBox[{"Length", "[", 
             RowBox[{
             "samples", "\[LeftDoubleBracket]", "1", 
              "\[RightDoubleBracket]"}], "]"}]}], "]"}]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{
        RowBox[{"thinning", "=", 
         RowBox[{"Floor", "[", 
          RowBox[{
           RowBox[{"Length", "[", 
            RowBox[{"First", "[", "samples", "]"}], "]"}], "/", "2000"}], 
          "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"samples", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"#", "\[LeftDoubleBracket]", 
            RowBox[{";;", ";;", "thinning"}], "\[RightDoubleBracket]"}], 
           "&"}], "/@", "samples"}]}], ";"}], "*)"}], "\[IndentingNewLine]", 
      RowBox[{"pairs", "=", 
       RowBox[{"Subsets", "[", 
        RowBox[{
         RowBox[{"Range", "[", 
          RowBox[{"Length", "[", "samples", "]"}], "]"}], ",", 
         RowBox[{"{", "2", "}"}]}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"asTrue", "=!=", "Null"}], ",", "\[IndentingNewLine]", 
        RowBox[{"plots", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{
              "samples", "\[LeftDoubleBracket]", "pair", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", "pair"}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", "1"}], ",", 
             RowBox[{"Epilog", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Red", ",", 
                RowBox[{"PointSize", "[", "0.05", "]"}], ",", 
                RowBox[{"Point", "[", 
                 RowBox[{
                 "asTrue", "\[LeftDoubleBracket]", "pair", 
                  "\[RightDoubleBracket]"}], "]"}]}], "}"}]}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"pair", ",", "pairs"}], "}"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"plots", "=", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"ListPlot", "[", 
            RowBox[{
             RowBox[{"Transpose", "@", 
              RowBox[{
              "samples", "\[LeftDoubleBracket]", "pair", 
               "\[RightDoubleBracket]"}]}], ",", 
             RowBox[{"PlotLabel", "\[Rule]", "pair"}], ",", 
             RowBox[{"AspectRatio", "\[Rule]", "1"}]}], "]"}], ",", 
           RowBox[{"{", 
            RowBox[{"pair", ",", "pairs"}], "}"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", "plots"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Histograms", "[", 
    RowBox[{"stanResult_StanResult", ",", "var_String", ",", 
     RowBox[{"trueValues_", ":", "Null"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", "samples", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"samples", "=", 
       RowBox[{"GetStanResult", "[", 
        RowBox[{"stanResult", ",", "var"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Table", "[", 
       RowBox[{
        RowBox[{"SmoothHistogram", "[", 
         RowBox[{
          RowBox[{
          "samples", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          ",", 
          RowBox[{"Epilog", "\[Rule]", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"trueValues", "=!=", "Null"}], "\[And]", 
              RowBox[{
               RowBox[{"Length", "[", "trueValues", "]"}], "\[Equal]", 
               RowBox[{"Length", "[", "samples", "]"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"Red", ",", "Dashed", ",", 
               RowBox[{"Line", "[", 
                RowBox[{"{", 
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "trueValues", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "0"}], "}"}], ",", 
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{
                    "trueValues", "\[LeftDoubleBracket]", "i", 
                    "\[RightDoubleBracket]"}], ",", "100"}], "}"}]}], "}"}], 
                "]"}]}], "}"}], ",", 
             RowBox[{"{", "}"}]}], "]"}]}]}], "]"}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "samples", "]"}]}], "}"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"IntSimpson", "[", "cf_Function", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"n", "=", 
        RowBox[{
         RowBox[{"2", " ", "25"}], "+", "1"}]}], ",", 
       RowBox[{"\[Epsilon]", "=", "0.00001"}], ",", "h", ",", "x", ",", "y", 
       ",", "y0", ",", "yN", ",", "intLimits", ",", "int"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"h", "=", 
       FractionBox[
        RowBox[{"1", "-", 
         RowBox[{"2", "\[Epsilon]"}]}], 
        RowBox[{"n", "-", "1"}]]}], ";", "\[IndentingNewLine]", 
      RowBox[{"x", "=", 
       RowBox[{"Range", "[", 
        RowBox[{"\[Epsilon]", ",", 
         RowBox[{"1", "-", "\[Epsilon]"}], ",", "h"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"y", "=", 
       RowBox[{"cf", "[", "x", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"y0", "=", 
       RowBox[{"First", "[", "y", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"yN", "=", 
       RowBox[{"Last", "[", "y", "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"intLimits", "=", 
       RowBox[{"\[Epsilon]", 
        RowBox[{"(", 
         RowBox[{"y0", "+", "yN"}], ")"}]}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"int", "=", 
       RowBox[{
        RowBox[{
         FractionBox["h", "3"], 
         RowBox[{"(", 
          RowBox[{"y0", "+", 
           RowBox[{"4", 
            RowBox[{"Total", "[", 
             RowBox[{"y", "\[LeftDoubleBracket]", 
              RowBox[{"2", ";;", 
               RowBox[{"-", "2"}], ";;", "2"}], "\[RightDoubleBracket]"}], 
             "]"}]}], "+", 
           RowBox[{"2", 
            RowBox[{"Total", "[", 
             RowBox[{"y", "\[LeftDoubleBracket]", 
              RowBox[{"3", ";;", 
               RowBox[{"-", "3"}], ";;", "2"}], "\[RightDoubleBracket]"}], 
             "]"}]}], "+", "yN"}], ")"}]}], "+", "intLimits"}]}], ";", 
      "\[IndentingNewLine]", "int"}]}], "\[IndentingNewLine]", "]"}]}], 
  ";"}]}], "Input",
 CellLabel->"In[52]:=",ExpressionUUID->"84352394-77b7-4dbf-84f1-d5b6f5c85776"],

Cell[CellGroupData[{

Cell["Two-point function", "Subsubsection",ExpressionUUID->"a7e24ad3-758b-48c1-8d28-3214da877b98"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Begin", "[", "\"\<TwoPoint`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Names", "[", "\"\<TwoPoint`*\>\"", "]"}], "]"}], ">", "0"}], 
    ",", 
    RowBox[{"Remove", "[", "\"\<TwoPoint`*\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cl", "[", 
    RowBox[{"a_List", ",", "zs_Real", ",", "\[Rho]_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"as", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"a", ",", 
         RowBox[{"-", 
          RowBox[{"Total", "[", "a", "]"}]}]}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"2", "zs", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SuperscriptBox["\[Rho]", "2"]}], ")"}], 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"b", "[", 
          RowBox[{"zs", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "]"}]]], 
       FractionBox[
        RowBox[{"2", "\[Rho]"}], 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[Rho]", "2"]}], ")"}], "2"]}]]]}], "+", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"2", 
         SuperscriptBox["zs", 
          RowBox[{"i", "+", "1"}]], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["\[Rho]", "2"]}], ")"}], 
          RowBox[{"i", "+", "1"}]], 
         FractionBox[
          RowBox[{
          "as", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          SqrtBox[
           RowBox[{"b", "[", 
            RowBox[{"zs", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "]"}]]], 
         FractionBox[
          RowBox[{"2", "\[Rho]"}], 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Rho]", "2"]}], ")"}], "2"]}]]]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "as", "]"}]}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Findzs", "[", 
    RowBox[{"as_List", ",", "l_Real"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zsLow", ",", "zsHigh", ",", "zsMid", ",", "lMid"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zsLow", "=", "0.0001"}], ";", "\[IndentingNewLine]", 
      RowBox[{"zsHigh", "=", "0.99999"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"zsHigh", "-", "zsLow"}], ">", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"zsMid", "=", 
          FractionBox[
           RowBox[{"zsHigh", "+", "zsLow"}], "2"]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lMid", "=", 
          RowBox[{"IntSimpson", "[", 
           RowBox[{
            RowBox[{"cl", "[", 
             RowBox[{"as", ",", "zsMid", ",", "#"}], "]"}], "&"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"(*", 
          RowBox[{
           RowBox[{"lMid", "=", 
            RowBox[{"a", ".", 
             RowBox[{"basis", "[", "zsMid", "]"}]}]}], ";"}], "*)"}], 
         "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"l", "<", "lMid"}], ",", 
           RowBox[{"zsHigh", "=", "zsMid"}], ",", 
           RowBox[{"zsLow", "=", "zsMid"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      FractionBox[
       RowBox[{"zsHigh", "+", "zsLow"}], "2"]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ctp", "[", 
    RowBox[{"a_List", ",", "zs_Real", ",", "\[Rho]_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"as", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"a", ",", 
         RowBox[{"-", 
          RowBox[{"Total", "[", "a", "]"}]}]}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"2", " ", 
       FractionBox[
        RowBox[{"2", "\[Rho]"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[Rho]", "2"]}], ")"}]], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          FractionBox["1", 
           SqrtBox[
            RowBox[{"b", "[", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["\[Rho]", "2"]}], ")"}], " ", "zs"}], "]"}]]], 
          
          FractionBox["1", 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["\[Rho]", "2"]}], ")"}], "2"]}]]]}], "-", 
         "1"}], ")"}]}], "+", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{"2", " ", 
         SuperscriptBox["zs", "i"], 
         FractionBox[
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[Rho]", "2"]}], ")"}], 
           RowBox[{"i", "-", "1"}]], 
          SqrtBox[
           RowBox[{"b", "[", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Rho]", "2"]}], ")"}], " ", "zs"}], "]"}]]], 
         FractionBox[
          RowBox[{
           RowBox[{
           "as", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], "2", 
           "\[Rho]"}], 
          SqrtBox[
           RowBox[{"1", "-", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Rho]", "2"]}], ")"}], "2"]}]]]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "as", "]"}]}], "}"}]}], "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tp", "[", 
    RowBox[{"as_List", ",", "zs_Real"}], "]"}], ":=", 
   RowBox[{"Exp", "[", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"IntSimpson", "[", 
       RowBox[{
        RowBox[{"ctp", "[", 
         RowBox[{"as", ",", "zs", ",", "#"}], "]"}], "&"}], "]"}]}], "-", 
     RowBox[{"2", 
      RowBox[{"Log", "[", "zs", "]"}]}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sample", "[", 
    RowBox[{"aSamples_List", ",", "lGrid_List", ",", "ns_Integer"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"T", "=", 
        FractionBox["1", "\[Pi]"]}], ",", "tpSamples", ",", "zs", ",", 
       "quantiles", ",", "plot", ",", "tpTrue"}], "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"progress", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"tpSamples", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"Length", "[", "lGrid", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"zs", "=", 
             RowBox[{"Findzs", "[", 
              RowBox[{"as", ",", 
               RowBox[{
               "lGrid", "\[LeftDoubleBracket]", "li", 
                "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "tpSamples", "\[LeftDoubleBracket]", "li", 
              "\[RightDoubleBracket]"}], "=", 
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{
                SuperscriptBox["T", 
                 RowBox[{"-", "2"}]], 
                RowBox[{"tp", "[", 
                 RowBox[{"as", ",", "zs"}], "]"}]}], "]"}], "@", 
              RowBox[{
              "tpSamples", "\[LeftDoubleBracket]", "li", 
               "\[RightDoubleBracket]"}]}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"li", ",", 
             RowBox[{"Length", "[", "lGrid", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"progress", "+=", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"as", ",", "aSamples"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "tpSamples"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakePlot", "[", 
   RowBox[{"stanResult_StanResult", ",", 
    RowBox[{"ns_", ":", "1000"}], ",", 
    RowBox[{"aTrue_", ":", "Null"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"T", "=", 
       FractionBox["1", "\[Pi]"]}], ",", "lGrid", ",", "aSamples", ",", 
      "nSamples", ",", "quantiles", ",", "tpSamples", ",", "tpTrue"}], "}"}], 
    ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lGrid", "=", 
      RowBox[{"Exp", "@", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"Log", "[", "0.01", "]"}], ",", 
         RowBox[{"Log", "[", "6", "]"}], ",", 
         FractionBox[
          RowBox[{
           RowBox[{"Log", "[", "6", "]"}], "-", 
           RowBox[{"Log", "[", "0.01", "]"}]}], "20"]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"aSamples", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"GetStanResult", "[", 
        RowBox[{"stanResult", ",", "\"\<a\>\""}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"aSamples", "=", 
      RowBox[{"RandomSample", "[", 
       RowBox[{"aSamples", ",", 
        RowBox[{"Min", "[", 
         RowBox[{"ns", ",", 
          RowBox[{"Length", "[", "aSamples", "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nSamples", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"ns", ",", 
        RowBox[{"Length", "[", "aSamples", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"tpSamples", "=", 
      RowBox[{"Sample", "[", 
       RowBox[{"aSamples", ",", "lGrid", ",", "nSamples"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"quantiles", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Quantile", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
           "0.025", ",", "0.25", ",", "0.5", ",", "0.75", ",", "0.975"}], 
           "}"}]}], "]"}], "&"}], "/@", "tpSamples"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plot", "=", 
      RowBox[{"ListLogPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", " ", "lGrid"}], ",", "#"}], "}"}], "]"}], "&"}], "/@", 
         RowBox[{"Transpose", "[", "quantiles", "]"}]}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SuperscriptBox[\(T\), \(\\\ \)]\)\[ScriptL]\>\"", ",", 
           "\"\<<OO\!\(\*SuperscriptBox[\(>\), \
\(1/\[CapitalDelta]\)]\)/\!\(\*SuperscriptBox[\(T\), \(2\)]\)\>\""}], "}"}]}],
         ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "LightGray", ",", "Gray", ",", "Black", ",", "Gray", ",", 
           "LightGray"}], "}"}]}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"0", ",", "Automatic"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"0.005", ",", "500"}], "}"}]}], "}"}]}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"aTrue", "=!=", "Null"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tpTrue", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", " ", "#"}], ",", 
             RowBox[{
              SuperscriptBox["T", 
               RowBox[{"-", "2"}]], 
              RowBox[{"tp", "[", 
               RowBox[{"aTrue", ",", 
                RowBox[{"Findzs", "[", 
                 RowBox[{"aTrue", ",", "#"}], "]"}]}], "]"}]}]}], "}"}], 
           "&"}], "/@", "lGrid"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", 
         RowBox[{"plot", ",", 
          RowBox[{"ListLogPlot", "[", 
           RowBox[{"tpTrue", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", "Dashed"}], "}"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], "]"}]}], ",", 
       "plot"}], "\[IndentingNewLine]", "]"}]}]}], "\[IndentingNewLine]", 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotTwoPoint", "[", 
   RowBox[{"stanResult_StanResult", ",", 
    RowBox[{"ns_", ":", "1000"}], ",", 
    RowBox[{"asTrue_", ":", "Null"}]}], "]"}], ":=", 
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{"TwoPoint`MakePlot", "[", 
     RowBox[{"stanResult", ",", "ns", ",", "asTrue"}], "]"}], ",", 
    "TwoPoint`progress"}], "]"}]}]}], "Input",
 CellLabel->"In[61]:=",ExpressionUUID->"90019644-7056-423b-8ae0-a4012c33912d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Temporal Wilson loop", "Subsubsection",ExpressionUUID->"ef561333-8811-48e2-86e9-bffef209fe80"],

Cell[TextData[{
 "The Wilson loop is given by\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    FractionBox["l", 
     SubscriptBox["z", "h"]], "=", 
    RowBox[{"2", 
     FractionBox[
      RowBox[{
       SubscriptBox["z", "*"], "/", 
       SubscriptBox["z", "h"]}], 
      SqrtBox[
       RowBox[{
        SubscriptBox["g", 
         RowBox[{"z", " ", "z"}]], "(", 
        SubscriptBox["z", "*"], ")"}]]], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       SuperscriptBox["y", "2"], 
       FractionBox[
        RowBox[{
         SubscriptBox["g", 
          RowBox[{"z", " ", "z"}]], "(", 
         RowBox[{"y", " ", 
          SubscriptBox["z", "*"]}], ")"}], 
        SqrtBox[
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["y", "4"], 
           RowBox[{
            RowBox[{
             SubscriptBox["g", 
              RowBox[{"z", " ", "z"}]], "(", 
             RowBox[{"y", " ", 
              SubscriptBox["z", "*"]}], ")"}], "/", 
            RowBox[{
             SubscriptBox["g", 
              RowBox[{"z", " ", "z"}]], "(", 
             SubscriptBox["z", "*"], ")"}]}]}]}]]], 
       RowBox[{"\[DifferentialD]", "y"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    SubscriptBox["S", 
     RowBox[{"N", " ", "G"}]], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Tau]", " ", 
       SuperscriptBox["R", "2"]}], 
      RowBox[{"\[Pi]", " ", 
       RowBox[{"\[Alpha]", "'"}]}]], 
     FractionBox["1", 
      SubscriptBox["z", "*"]], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", 
       RowBox[{"\[Epsilon]", "/", 
        SubscriptBox["z", "*"]}], "1"], 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["y", "2"]], 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"1", "-", 
          RowBox[{
           SuperscriptBox["y", "4"], 
           RowBox[{
            RowBox[{
             SubscriptBox["g", 
              RowBox[{"z", " ", "z"}]], "(", 
             RowBox[{"y", " ", 
              SubscriptBox["z", "*"]}], ")"}], "/", 
            RowBox[{
             SubscriptBox["g", 
              RowBox[{"z", " ", "z"}]], "(", 
             SubscriptBox["z", "*"], ")"}]}]}]}]]], 
       RowBox[{"\[DifferentialD]", "y"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"\[Tau]", " ", 
        SuperscriptBox["R", "2"]}], 
       RowBox[{"\[Pi]", " ", 
        RowBox[{"\[Alpha]", "'"}]}]], 
      FractionBox["1", "\[Epsilon]"]}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"\[Tau]", " ", 
        SuperscriptBox["R", "2"]}], 
       RowBox[{"\[Pi]", " ", 
        RowBox[{"\[Alpha]", "'"}]}]], 
      FractionBox["1", 
       SubscriptBox["z", "*"]]}], "+", 
     RowBox[{
      FractionBox[
       RowBox[{"\[Tau]", " ", 
        SuperscriptBox["R", "2"]}], 
       RowBox[{"\[Pi]", " ", 
        RowBox[{"\[Alpha]", "'"}]}]], 
      FractionBox["1", 
       SubscriptBox["z", "*"]], 
      RowBox[{
       SubsuperscriptBox["\[Integral]", "0", "1"], 
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["y", "2"]], 
        RowBox[{"(", 
         RowBox[{
          FractionBox["1", 
           SqrtBox[
            RowBox[{"1", "-", 
             RowBox[{
              SuperscriptBox["y", "4"], 
              RowBox[{
               RowBox[{
                SubscriptBox["g", 
                 RowBox[{"z", " ", "z"}]], "(", 
                RowBox[{"y", " ", 
                 SubscriptBox["z", "*"]}], ")"}], "/", 
               RowBox[{
                SubscriptBox["g", 
                 RowBox[{"z", " ", "z"}]], "(", 
                SubscriptBox["z", "*"], ")"}]}]}]}]]], "-", "1"}], ")"}], 
        RowBox[{
         RowBox[{"\[DifferentialD]", "y"}], " ", "."}]}]}]}]}]}], 
   TraditionalForm]}],ExpressionUUID->
  "d8fe025c-11cd-4033-b9e7-b7ca01f4556a"],
 "\nIn the temporal Wilson loop, the integrals do not reduce to a sum of \
integrals. The actual Wilson loop and the associated potential are\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     RowBox[{"W", "(", "C", ")"}], "\[RightAngleBracket]"}], "=", 
    SuperscriptBox["\[ExponentialE]", 
     RowBox[{"-", 
      SubscriptBox["S", 
       RowBox[{"N", " ", "G"}]]}]]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"V", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "ln"}], 
      RowBox[{
       RowBox[{"\[LeftAngleBracket]", 
        RowBox[{"W", "(", "C", ")"}], "\[RightAngleBracket]"}], "/", 
       "\[Tau]"}]}], "=", 
     RowBox[{
      FractionBox[
       SubscriptBox["S", 
        RowBox[{"N", " ", "G"}]], "\[Tau]"], " ", "."}]}]}], 
   TraditionalForm]}],ExpressionUUID->
  "c774f8b1-ef46-4c31-842f-541e3ed1c676"],
 "\nThe string tension is defined by ",
 Cell[BoxData[
  FormBox[
   RowBox[{"V", "=", 
    RowBox[{"\[Sigma]", " ", "l"}]}], TraditionalForm]],ExpressionUUID->
  "937dcf67-ee56-44b4-938e-079d7fe074b6"],
 ", so\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{"\[Sigma]", "=", 
    FractionBox[
     RowBox[{"d", " ", "V"}], 
     RowBox[{"d", " ", "l"}]]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     FractionBox["1", "\[Tau]"], 
     RowBox[{
      FractionBox[
       RowBox[{"d", " ", 
        SubscriptBox["S", 
         RowBox[{"N", " ", "G"}]]}], 
       RowBox[{"d", " ", "l"}]], " ", "."}]}]}], TraditionalForm]}],
  ExpressionUUID->"a6340290-ec99-47bb-abdf-deef82de693e"],
 "\nInterestingly, one can use the chain rule to show that\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    FractionBox[
     RowBox[{"d", " ", 
      SubscriptBox["S", 
       RowBox[{"N", " ", "G"}]]}], 
     RowBox[{"d", " ", "l"}]], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"\[Tau]", " ", 
       SuperscriptBox["R", "2"]}], 
      RowBox[{"2", "\[Pi]", " ", 
       RowBox[{"\[Alpha]", "'"}]}]], 
     FractionBox["1", 
      RowBox[{
       SqrtBox[
        RowBox[{
         SubscriptBox["g", 
          RowBox[{"z", " ", "z"}]], "(", 
         SubscriptBox["z", "*"], ")"}]], 
       SuperscriptBox[
        SubscriptBox["z", "*"], "2"]}]]}]}], TraditionalForm]],ExpressionUUID->
  "6d5bd321-679a-4926-9771-032eca6773ca"],
 " ."
}], "Text",ExpressionUUID->"9c89a133-f489-4c35-bb1f-39cd92044df6"],

Cell[TextData[{
 "There is also the piecewise smooth configuration where the string dives to \
the horizon. The piece of world sheet along the horizon has vanishing area. \
This configuration has action\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    SuperscriptBox[
     SubscriptBox["S", 
      RowBox[{"N", " ", "G"}]], 
     RowBox[{"(", "horizon", ")"}]], "=", 
    RowBox[{
     FractionBox[
      RowBox[{"T", " ", 
       SuperscriptBox["R", "2"]}], 
      RowBox[{"\[Pi]", " ", 
       RowBox[{"\[Alpha]", "'"}]}]], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "\[Epsilon]", 
       SubscriptBox["z", "h"]], 
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["z", "2"]], 
       RowBox[{"\[DifferentialD]", "z"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      FractionBox[
       RowBox[{"T", " ", 
        SuperscriptBox["R", "2"]}], 
       RowBox[{"\[Pi]", " ", 
        RowBox[{"\[Alpha]", "'"}]}]], 
      FractionBox["1", "\[Epsilon]"]}], "-", 
     RowBox[{
      FractionBox[
       RowBox[{"T", " ", 
        SuperscriptBox["R", "2"]}], 
       RowBox[{"\[Pi]", " ", 
        RowBox[{"\[Alpha]", "'"}]}]], 
      RowBox[{
       FractionBox["1", 
        SubscriptBox["z", "h"]], " ", "."}]}]}]}], TraditionalForm]}],
  ExpressionUUID->"4867d8f0-5ba5-4f19-a516-07c927c267db"]
}], "Text",ExpressionUUID->"bdf821d2-a2f1-4ab7-88d2-4099567e6c07"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Begin", "[", "\"\<Wilson`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Length", "[", 
      RowBox[{"Names", "[", "\"\<Wilson`*\>\"", "]"}], "]"}], ">", "0"}], ",", 
    RowBox[{"Remove", "[", "\"\<Wilson`*\>\"", "]"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cl", "[", 
    RowBox[{"as_List", ",", "zs_Real", ",", "\[Rho]_"}], "]"}], ":=", 
   RowBox[{"2", " ", 
    FractionBox["zs", 
     SqrtBox[
      RowBox[{"gzz", "[", 
       RowBox[{"as", ",", "zs"}], "]"}]]], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"1", "-", 
       SuperscriptBox["\[Rho]", "2"]}], ")"}], "2"], 
    FractionBox[
     RowBox[{"2", "\[Rho]", " ", 
      RowBox[{"gzz", "[", 
       RowBox[{"as", ",", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["\[Rho]", "2"]}], ")"}], " ", "zs"}]}], "]"}]}], 
     SqrtBox[
      RowBox[{"1", "-", 
       RowBox[{
        FractionBox[
         RowBox[{"gzz", "[", 
          RowBox[{"as", ",", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["\[Rho]", "2"]}], ")"}], " ", "zs"}]}], "]"}], 
         RowBox[{"gzz", "[", 
          RowBox[{"as", ",", "zs"}], "]"}]], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["\[Rho]", "2"]}], ")"}], "4"]}]}]]]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"l", "[", 
    RowBox[{"as_List", ",", "zs_Real"}], "]"}], ":=", 
   RowBox[{"IntSimpson", "[", 
    RowBox[{
     RowBox[{"cl", "[", 
      RowBox[{"as", ",", "zs", ",", "#"}], "]"}], "&"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cld", "[", 
    RowBox[{"as_List", ",", "zs_Real", ",", "\[Rho]_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"4", " ", "\[Rho]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[Rho]", "2"]}], ")"}], "2"], " ", 
       RowBox[{"gzz", "[", 
        RowBox[{"as", ",", 
         RowBox[{"zs", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["\[Rho]", "2"]}], ")"}]}]}], "]"}]}], "-", 
      FractionBox[
       RowBox[{"2", " ", "zs", " ", "\[Rho]", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["\[Rho]", "2"]}], ")"}], "2"], " ", 
        RowBox[{"gzz", "[", 
         RowBox[{"as", ",", 
          RowBox[{"zs", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[Rho]", "2"]}], ")"}]}]}], "]"}], " ", 
        RowBox[{"gzzp", "[", 
         RowBox[{"as", ",", "zs"}], "]"}]}], 
       RowBox[{"gzz", "[", 
        RowBox[{"as", ",", "zs"}], "]"}]], "+", 
      RowBox[{"4", " ", "zs", " ", "\[Rho]", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[Rho]", "2"]}], ")"}], "3"], " ", 
       RowBox[{"gzzp", "[", 
        RowBox[{"as", ",", 
         RowBox[{"zs", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["\[Rho]", "2"]}], ")"}]}]}], "]"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"2", " ", "zs", " ", "\[Rho]", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["\[Rho]", "2"]}], ")"}], "2"], " ", 
         RowBox[{"gzz", "[", 
          RowBox[{"as", ",", 
           RowBox[{"zs", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["\[Rho]", "2"]}], ")"}]}]}], "]"}], " ", 
         RowBox[{"(", 
          RowBox[{
           FractionBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["\[Rho]", "2"]}], ")"}], "4"], " ", 
             RowBox[{"gzz", "[", 
              RowBox[{"as", ",", 
               RowBox[{"zs", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  SuperscriptBox["\[Rho]", "2"]}], ")"}]}]}], "]"}], " ", 
             RowBox[{"gzzp", "[", 
              RowBox[{"as", ",", "zs"}], "]"}]}], 
            SuperscriptBox[
             RowBox[{"gzz", "[", 
              RowBox[{"as", ",", "zs"}], "]"}], "2"]], "-", 
           FractionBox[
            RowBox[{
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["\[Rho]", "2"]}], ")"}], "5"], " ", 
             RowBox[{"gzzp", "[", 
              RowBox[{"as", ",", 
               RowBox[{"zs", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "-", 
                  SuperscriptBox["\[Rho]", "2"]}], ")"}]}]}], "]"}]}], 
            RowBox[{"gzz", "[", 
             RowBox[{"as", ",", "zs"}], "]"}]]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         FractionBox[
          RowBox[{
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"1", "-", 
              SuperscriptBox["\[Rho]", "2"]}], ")"}], "4"], " ", 
           RowBox[{"gzz", "[", 
            RowBox[{"as", ",", 
             RowBox[{"zs", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["\[Rho]", "2"]}], ")"}]}]}], "]"}]}], 
          RowBox[{"gzz", "[", 
           RowBox[{"as", ",", "zs"}], "]"}]]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SqrtBox[
       RowBox[{"gzz", "[", 
        RowBox[{"as", ",", "zs"}], "]"}]], " ", 
      SqrtBox[
       RowBox[{"1", "-", 
        FractionBox[
         RowBox[{
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[Rho]", "2"]}], ")"}], "4"], " ", 
          RowBox[{"gzz", "[", 
           RowBox[{"as", ",", 
            RowBox[{"zs", " ", 
             RowBox[{"(", 
              RowBox[{"1", "-", 
               SuperscriptBox["\[Rho]", "2"]}], ")"}]}]}], "]"}]}], 
         RowBox[{"gzz", "[", 
          RowBox[{"as", ",", "zs"}], "]"}]]}]]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ld", "[", 
    RowBox[{"as_List", ",", "zs_Real"}], "]"}], ":=", 
   RowBox[{"IntSimpson", "[", 
    RowBox[{
     RowBox[{"cld", "[", 
      RowBox[{"as", ",", "zs", ",", "#"}], "]"}], "&"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindMaxl", "[", "as_List", "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zsLow", ",", "zsHigh", ",", "zsMid", ",", "dldzs"}], "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zsLow", "=", "0.0001"}], ";", "\[IndentingNewLine]", 
      RowBox[{"zsHigh", "=", "0.99999"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"zsHigh", "-", "zsLow"}], ">", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"zsMid", "=", 
          FractionBox[
           RowBox[{"zsHigh", "+", "zsLow"}], "2"]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"dldzs", "=", 
          RowBox[{"IntSimpson", "[", 
           RowBox[{
            RowBox[{"cld", "[", 
             RowBox[{"as", ",", "zsMid", ",", "#"}], "]"}], "&"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"dldzs", ">", "0.0"}], ",", 
           RowBox[{"zsLow", "=", "zsMid"}], ",", 
           RowBox[{"zsHigh", "=", "zsMid"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"zsMid", "=", 
       FractionBox[
        RowBox[{"zsHigh", "+", "zsLow"}], "2"]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"{", 
       RowBox[{"zsMid", ",", 
        RowBox[{"l", "[", 
         RowBox[{"as", ",", "zsMid"}], "]"}]}], "}"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cng", "[", 
    RowBox[{"as_List", ",", "zs_Real", ",", "\[Rho]_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"2", "\[Rho]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[Rho]", "2"]}], ")"}], "2"]], 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{
          FractionBox[
           RowBox[{"gzz", "[", 
            RowBox[{"as", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["\[Rho]", "2"]}], ")"}], " ", "zs"}]}], "]"}], 
           
           RowBox[{"gzz", "[", 
            RowBox[{"as", ",", "zs"}], "]"}]], 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[Rho]", "2"]}], ")"}], "4"]}]}], ")"}], 
       RowBox[{
        RowBox[{"-", "1"}], "/", "2"}]], "-", "1"}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SNG", "[", 
    RowBox[{"as_List", ",", "zs_Real"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["2", "zs"]}], "+", 
    RowBox[{
     FractionBox["2", "zs"], 
     RowBox[{"IntSimpson", "[", 
      RowBox[{
       RowBox[{"cng", "[", 
        RowBox[{"as", ",", "zs", ",", "#"}], "]"}], "&"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"SNGHorizon", "=", 
   RowBox[{"-", "2.0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"FindSNG", "[", 
    RowBox[{"as_List", ",", "l_Real", ",", "zsMax_Real"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "lMax", ",", "zsLow", ",", "zsHigh", ",", "zsMid", ",", "lmid"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
       "We", " ", "assume", " ", "that", " ", "the", " ", "true", " ", 
        "minima", " ", "is", " ", "never", " ", "in", " ", "zs"}], ">", 
       RowBox[{
        RowBox[{"zsmax", ".", " ", "This"}], " ", "is", " ", "guaranteed", 
        " ", "to", " ", "happen", " ", "when", " ", 
        RowBox[{"dSNG", "/", "dd"}], " ", "is", " ", 
        RowBox[{"monotonous", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zsLow", "=", "0.0001"}], ";", "\[IndentingNewLine]", 
      RowBox[{"zsHigh", "=", "zsMax"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"zsHigh", "-", "zsLow"}], ">", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"zsMid", "=", 
          FractionBox[
           RowBox[{"zsHigh", "+", "zsLow"}], "2"]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lmid", "=", 
          RowBox[{"IntSimpson", "[", 
           RowBox[{
            RowBox[{"cl", "[", 
             RowBox[{"as", ",", "zsMid", ",", "#"}], "]"}], "&"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"l", "<", "lmid"}], ",", 
           RowBox[{"zsHigh", "=", "zsMid"}], ",", 
           RowBox[{"zsLow", "=", "zsMid"}]}], "]"}], ";"}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"zsMid", "=", 
       FractionBox[
        RowBox[{"zsHigh", "+", "zsLow"}], "2"]}], ";", "\[IndentingNewLine]", 
      
      RowBox[{"SNG", "[", 
       RowBox[{"as", ",", "zsMid"}], "]"}]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sample", "[", 
    RowBox[{"aSamples_List", ",", "lGrid_List", ",", "ns_Integer"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "wlSamples", ",", "zsMax", ",", "lMax", ",", "sng", ",", "quantiles", 
       ",", "plot", ",", "tpTrue"}], "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"progress", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"wlSamples", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"Length", "[", "lGrid", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{"zsMax", ",", "lMax"}], "}"}], "=", 
          RowBox[{"FindMaxl", "[", "as", "]"}]}], ";", "\[IndentingNewLine]", 
         
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"If", "[", 
             RowBox[{
              RowBox[{
               RowBox[{
               "lGrid", "\[LeftDoubleBracket]", "li", 
                "\[RightDoubleBracket]"}], ">", "lMax"}], ",", 
              RowBox[{
               RowBox[{
                RowBox[{
                "wlSamples", "\[LeftDoubleBracket]", "li", 
                 "\[RightDoubleBracket]"}], "=", 
                RowBox[{
                 RowBox[{"Prepend", "[", "0.0", "]"}], "@", 
                 RowBox[{
                 "wlSamples", "\[LeftDoubleBracket]", "li", 
                  "\[RightDoubleBracket]"}]}]}], ";", 
               RowBox[{"Continue", "[", "]"}]}]}], "]"}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sng", "=", 
             RowBox[{"FindSNG", "[", 
              RowBox[{"as", ",", 
               RowBox[{
               "lGrid", "\[LeftDoubleBracket]", "li", 
                "\[RightDoubleBracket]"}], ",", "zsMax"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{"sng", "=", 
             RowBox[{"Min", "[", 
              RowBox[{"sng", ",", "SNGHorizon"}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "wlSamples", "\[LeftDoubleBracket]", "li", 
              "\[RightDoubleBracket]"}], "=", 
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{"sng", "-", "SNGHorizon"}], "]"}], "@", 
              RowBox[{
              "wlSamples", "\[LeftDoubleBracket]", "li", 
               "\[RightDoubleBracket]"}]}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"li", ",", 
             RowBox[{"Length", "[", "lGrid", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"progress", "+=", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"as", ",", "aSamples"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "wlSamples"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MakePlot", "[", 
   RowBox[{"stanResult_StanResult", ",", 
    RowBox[{"ns_", ":", "1000"}], ",", 
    RowBox[{"aTrue_", ":", "Null"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"T", "=", 
       FractionBox["1", "\[Pi]"]}], ",", "lGrid", ",", "aSamples", ",", 
      "nSamples", ",", "quantiles", ",", "wlSamples", ",", "zsMax", ",", 
      "wlTrue"}], "}"}], ",", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"lGrid", "=", 
      RowBox[{"Exp", "@", 
       RowBox[{"Range", "[", 
        RowBox[{
         RowBox[{"Log", "[", "0.05", "]"}], ",", 
         RowBox[{"Log", "[", "1.3", "]"}], ",", 
         FractionBox[
          RowBox[{
           RowBox[{"Log", "[", "1.3", "]"}], "-", 
           RowBox[{"Log", "[", "0.05", "]"}]}], "20"]}], "]"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"aSamples", "=", 
      RowBox[{"Transpose", "[", 
       RowBox[{"GetStanResult", "[", 
        RowBox[{"stanResult", ",", "\"\<a\>\""}], "]"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"aSamples", "=", 
      RowBox[{"RandomSample", "[", 
       RowBox[{"aSamples", ",", 
        RowBox[{"Min", "[", 
         RowBox[{"ns", ",", 
          RowBox[{"Length", "[", "aSamples", "]"}]}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"nSamples", "=", 
      RowBox[{"Min", "[", 
       RowBox[{"ns", ",", 
        RowBox[{"Length", "[", "aSamples", "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"wlSamples", "=", 
      RowBox[{"Sample", "[", 
       RowBox[{"aSamples", ",", "lGrid", ",", "nSamples"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"quantiles", "=", 
      RowBox[{
       RowBox[{
        RowBox[{"Quantile", "[", 
         RowBox[{"#", ",", 
          RowBox[{"{", 
           RowBox[{
           "0.025", ",", "0.25", ",", "0.5", ",", "0.75", ",", "0.975"}], 
           "}"}]}], "]"}], "&"}], "/@", "wlSamples"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"plot", "=", 
      RowBox[{"ListPlot", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Thread", "[", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", " ", "lGrid"}], ",", 
             RowBox[{
              FractionBox["1", "\[Pi]"], "#"}]}], "}"}], "]"}], "&"}], "/@", 
         RowBox[{"Transpose", "[", "quantiles", "]"}]}], ",", 
        RowBox[{"AxesLabel", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "\"\<\!\(\*SuperscriptBox[\(T\), \(\\\ \)]\)\[ScriptL]\>\"", ",", 
           "\"\<\!\(\*FractionBox[\(\[Alpha]'\\\ V\), \(T\\\ \
\*SuperscriptBox[\(R\), \(2\)]\)]\)\>\""}], "}"}]}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
          "LightGray", ",", "Gray", ",", "Black", ",", "Gray", ",", 
           "LightGray"}], "}"}]}], ",", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Automatic", ",", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"-", "5"}], ",", "1"}], "}"}]}], "}"}]}]}], "]"}]}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"aTrue", "=!=", "Null"}], ",", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"zsMax", "=", 
         RowBox[{"First", "@", 
          RowBox[{"FindMaxl", "[", "aTrue", "]"}]}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"wlTrue", "=", 
         RowBox[{
          RowBox[{
           RowBox[{"{", 
            RowBox[{
             RowBox[{"T", " ", "#"}], ",", 
             RowBox[{
              FractionBox["1", "\[Pi]"], 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Min", "[", 
                 RowBox[{"SNGHorizon", ",", 
                  RowBox[{"FindSNG", "[", 
                   RowBox[{"aTrue", ",", "#", ",", "zsMax"}], "]"}]}], "]"}], 
                "-", "SNGHorizon"}], ")"}]}]}], "}"}], "&"}], "/@", 
          "lGrid"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"Show", "[", 
         RowBox[{"plot", ",", 
          RowBox[{"ListPlot", "[", 
           RowBox[{"wlTrue", ",", 
            RowBox[{"PlotStyle", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{"Red", ",", "Dashed"}], "}"}]}], ",", 
            RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], "]"}]}], ",", 
       "\[IndentingNewLine]", "plot"}], "\[IndentingNewLine]", "]"}]}]}], 
   "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotWilson", "[", 
   RowBox[{"stanResult_StanResult", ",", 
    RowBox[{"ns_", ":", "1000"}], ",", 
    RowBox[{"aTrue_", ":", "Null"}]}], "]"}], ":=", 
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{"Wilson`MakePlot", "[", 
     RowBox[{"stanResult", ",", "ns", ",", "aTrue"}], "]"}], ",", 
    "Wilson`progress"}], "]"}]}]}], "Input",
 CellLabel->"In[71]:=",ExpressionUUID->"78c3847b-13ed-478f-92ab-c5f527768ad4"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spatial Wilson loop", "Subsubsection",ExpressionUUID->"1be514bb-0373-41c0-89c7-600106a75237"],

Cell[TextData[{
 "This time we consider a rectangular loop in ",
 Cell[BoxData[
  FormBox[
   RowBox[{"(", 
    RowBox[{"x", ",", "y"}], ")"}], TraditionalForm]],ExpressionUUID->
  "d20d551e-ff98-4690-926d-fd26d6f4ba33"],
 "-plane.\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "l"}], "/", "2"}], "\[LessEqual]", "x", "\[LessEqual]", 
    RowBox[{"l", "/", "2"}]}], TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["L", "y"]}], "/", "2"}], "\[LessEqual]", "y", 
     "\[LessEqual]", 
     RowBox[{
      SubscriptBox["L", "y"], "/", "2"}]}], " ", ","}], TraditionalForm]}],
  ExpressionUUID->"dda417a1-f9ed-4f1d-a1c8-c9cc95fa5cba"],
 "\nwhere ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["L", "y"], "\[Rule]", "\[Infinity]"}], TraditionalForm]],
  ExpressionUUID->"780d3a15-e6af-43c8-98b7-186564592d87"],
 " . Then\n",
 Cell[BoxData[{
  FormBox[
   RowBox[{
    FractionBox["l", 
     SubscriptBox["z", "h"]], "=", 
    RowBox[{"2", 
     FractionBox[
      SubscriptBox["z", "*"], 
      SubscriptBox["z", "h"]], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       SuperscriptBox["y", "2"], 
       FractionBox[
        RowBox[{"a", "(", 
         RowBox[{"y", " ", 
          SubscriptBox["z", "*"]}], ")"}], 
        SqrtBox[
         RowBox[{"b", "(", 
          RowBox[{"y", " ", 
           SubscriptBox["z", "*"]}], ")"}]]], 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["y", "4"]}]]], 
       RowBox[{"\[DifferentialD]", "y"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{"=", 
    RowBox[{
     RowBox[{
      SubscriptBox["l", "0"], "(", 
      SubscriptBox["z", "*"], ")"}], "+", 
     RowBox[{
      UnderoverscriptBox["\[Sum]", 
       RowBox[{"i", "=", "1"}], 
       SubscriptBox["N", "basis"]], 
      RowBox[{
       SubscriptBox["a", "i"], 
       RowBox[{
        SubscriptBox["l", "i"], "(", 
        SubscriptBox["z", "*"], ")"}]}]}]}]}], 
   TraditionalForm], "\[IndentingNewLine]", 
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["S", 
      RowBox[{"N", " ", "G"}]], "=", 
     RowBox[{
      FractionBox[
       RowBox[{
        SubscriptBox["L", "y"], 
        SuperscriptBox["R", "2"]}], 
       RowBox[{"\[Pi]", " ", 
        RowBox[{"\[Alpha]", "'"}]}]], 
      SuperscriptBox[
       SubscriptBox["z", "*"], 
       RowBox[{"-", "1"}]], 
      RowBox[{
       SubsuperscriptBox["\[Integral]", 
        RowBox[{"\[Epsilon]", "/", 
         SubscriptBox["z", "*"]}], "1"], 
       RowBox[{
        SuperscriptBox["y", 
         RowBox[{"-", "2"}]], 
        FractionBox[
         RowBox[{"a", "(", 
          RowBox[{"y", " ", 
           SubscriptBox["z", "*"]}], ")"}], 
         SqrtBox[
          RowBox[{"b", "(", 
           RowBox[{"y", " ", 
            SubscriptBox["z", "*"]}], ")"}]]], 
        FractionBox["1", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["y", "4"]}]]], 
        RowBox[{"\[DifferentialD]", "y"}]}]}]}]}], " ", ","}], 
   TraditionalForm]}],ExpressionUUID->
  "33ccb7fc-6b93-45c5-9499-a526293f2272"],
 "\nwhere\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     SubscriptBox["l", "i"], "(", 
     SubscriptBox["z", "*"], ")"}], "=", 
    RowBox[{"2", 
     SuperscriptBox[
      RowBox[{"(", 
       FractionBox[
        SubscriptBox["z", "*"], 
        SubscriptBox["z", "h"]], ")"}], 
      RowBox[{"i", "+", "1"}]], 
     RowBox[{
      SubsuperscriptBox["\[Integral]", "0", "1"], 
      RowBox[{
       FractionBox[
        SuperscriptBox["y", 
         RowBox[{"2", "+", "i"}]], 
        SqrtBox[
         RowBox[{"b", "(", 
          RowBox[{"y", " ", 
           SubscriptBox["z", "*"]}], ")"}]]], 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["y", "4"]}]]], 
       RowBox[{
        RowBox[{"\[DifferentialD]", "y"}], " ", "."}]}]}]}]}], 
   TraditionalForm]],ExpressionUUID->"c8eeeb3f-9c83-4455-b134-a86ce40c2766"],
 "\nThis time the regularization of ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", 
    RowBox[{"N", " ", "G"}]], TraditionalForm]],ExpressionUUID->
  "b0b5d691-49e1-4007-9213-572ef68c426e"],
 " will depend on the coefficients ",
 Cell[BoxData[
  FormBox["a", TraditionalForm]],ExpressionUUID->
  "e90cc1e1-d8c6-4211-920e-49011005de60"],
 " so we can\[CloseCurlyQuote]t compare ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["S", 
    RowBox[{"N", " ", "G"}]], TraditionalForm]],ExpressionUUID->
  "70cb82bf-3b83-4b39-9e49-20a8a36e9d15"],
 " between different metrics. To get rid of the divergences, we consider its \
derivative instead. One can show that\n",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"2", "\[Pi]", " ", 
       RowBox[{"\[Alpha]", "'"}]}], 
      RowBox[{
       SubscriptBox["L", "y"], 
       SuperscriptBox["R", "2"]}]], 
     FractionBox[
      RowBox[{"d", " ", 
       SubscriptBox["S", 
        RowBox[{"N", " ", "G"}]]}], 
      RowBox[{"d", " ", "l"}]]}], "=", 
    FractionBox["1", 
     SuperscriptBox[
      SubscriptBox["z", "*"], "2"]]}], TraditionalForm]],ExpressionUUID->
  "a021d920-ae10-4643-8581-7c7efc0140c2"],
 " ."
}], "Text",ExpressionUUID->"c0a4be44-5976-446b-af57-ed0e83e96bda"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Begin", "[", "\"\<SpatialWilson`\>\"", "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"If", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Length", "[", 
       RowBox[{"Names", "[", "\"\<SpatialWilson`*\>\"", "]"}], "]"}], ">", 
      "0"}], ",", 
     RowBox[{"Remove", "[", "\"\<SpatialWilson`*\>\"", "]"}]}], "]"}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", 
   RowBox[{"Width", ",", " ", 
    RowBox[{"Nambu", "-", 
     RowBox[{"Goto", " ", "action", " ", 
      RowBox[{"value", "."}]}]}]}], " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cl", "[", 
    RowBox[{"a_List", ",", "zs_Real", ",", "\[Rho]_"}], "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"as", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"a", ",", 
         RowBox[{"-", 
          RowBox[{"Total", "[", "a", "]"}]}]}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"2", "zs", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SuperscriptBox["\[Rho]", "2"]}], ")"}], "2"], 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"b", "[", 
          RowBox[{"zs", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "]"}]]], 
       FractionBox[
        RowBox[{"2", "\[Rho]"}], 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[Rho]", "2"]}], ")"}], "4"]}]]]}], "+", 
      RowBox[{"2", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          SuperscriptBox["zs", 
           RowBox[{"i", "+", "1"}]], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[Rho]", "2"]}], ")"}], 
           RowBox[{"2", "+", "i"}]], 
          FractionBox[
           RowBox[{
           "as", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
           SqrtBox[
            RowBox[{"b", "[", 
             RowBox[{"zs", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["\[Rho]", "2"]}], ")"}]}], "]"}]]], 
          FractionBox[
           RowBox[{"2", "\[Rho]"}], 
           SqrtBox[
            RowBox[{"1", "-", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                SuperscriptBox["\[Rho]", "2"]}], ")"}], "4"]}]]]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", 
           RowBox[{"Length", "[", "as", "]"}]}], "}"}]}], "]"}]}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SNG", "[", 
    RowBox[{"0", ",", "zs_Real"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["2", "zs"]}], "+", 
    RowBox[{
     FractionBox["2", "zs"], 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", 
         SuperscriptBox["y", "2"]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", 
            SqrtBox[
             RowBox[{"b", "[", 
              RowBox[{"zs", " ", "y"}], "]"}]]], 
           FractionBox["1", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["y", "4"]}]]]}], "-", "1"}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SNG", "[", 
    RowBox[{"1", ",", "zs_Real"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"2", 
     RowBox[{"Log", "[", "zs", "]"}]}], "+", 
    RowBox[{"2", 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        FractionBox["1", "y"], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox["1", 
            SqrtBox[
             RowBox[{"b", "[", 
              RowBox[{"zs", " ", "y"}], "]"}]]], 
           FractionBox["1", 
            SqrtBox[
             RowBox[{"1", "-", 
              SuperscriptBox["y", "4"]}]]]}], "-", "1"}], ")"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"SNG", "[", 
     RowBox[{"i_Integer", ",", "zs_Real"}], "]"}], ":=", 
    RowBox[{"2", 
     SuperscriptBox["zs", 
      RowBox[{"i", "-", "1"}]], 
     RowBox[{"NIntegrate", "[", 
      RowBox[{
       RowBox[{
        FractionBox[
         SuperscriptBox["y", 
          RowBox[{"i", "-", "2"}]], 
         SqrtBox[
          RowBox[{"b", "[", 
           RowBox[{"zs", " ", "y"}], "]"}]]], 
        FractionBox["1", 
         SqrtBox[
          RowBox[{"1", "-", 
           SuperscriptBox["y", "4"]}]]]}], ",", 
       RowBox[{"{", 
        RowBox[{"y", ",", "0", ",", "1"}], "}"}]}], "]"}]}]}], ";"}], 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
     RowBox[{"SNG", "[", 
      RowBox[{"as_List", ",", "zs_Real"}], "]"}], ":=", 
     RowBox[{
      RowBox[{"SNG", "[", 
       RowBox[{"0", ",", "zs"}], "]"}], "+", 
      RowBox[{"Sum", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"as", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
         RowBox[{"SNG", "[", 
          RowBox[{"i", ",", "zs"}], "]"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"i", ",", 
          RowBox[{"Length", "[", "as", "]"}]}], "}"}]}], "]"}]}]}], ";"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SNGFull", "[", 
    RowBox[{"as_List", ",", "zs_Real", ",", 
     RowBox[{"\[Epsilon]_Real", ":", 
      SuperscriptBox["10", 
       RowBox[{"-", "10"}]]}]}], "]"}], ":=", 
   RowBox[{
    FractionBox["2", "zs"], 
    RowBox[{"NIntegrate", "[", 
     RowBox[{
      RowBox[{
       FractionBox["1", 
        SuperscriptBox["y", "2"]], 
       SqrtBox[
        RowBox[{"gzz", "[", 
         RowBox[{"as", ",", 
          RowBox[{"y", " ", "zs"}]}], "]"}]], 
       FractionBox["1", 
        SqrtBox[
         RowBox[{"1", "-", 
          SuperscriptBox["y", "4"]}]]]}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"\[Epsilon]", "/", "zs"}], ",", "1"}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SNGHorizon", "[", "a_List", "]"}], ":=", 
   RowBox[{"With", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"as", "=", 
       RowBox[{"Append", "[", 
        RowBox[{"a", ",", 
         RowBox[{"-", 
          RowBox[{"Total", "[", "a", "]"}]}]}], "]"}]}], "}"}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"2", 
         SqrtBox["\[Pi]"], " ", 
         RowBox[{"Gamma", "[", 
          FractionBox["3", "4"], "]"}]}], 
        RowBox[{"Gamma", "[", 
         FractionBox["1", "4"], "]"}]]}], "+", 
      RowBox[{
       RowBox[{"as", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
       RowBox[{"Log", "[", "2", "]"}]}], "+", 
      RowBox[{"2", 
       RowBox[{"Sum", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
          "as", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
          FractionBox[
           RowBox[{
            SqrtBox["\[Pi]"], 
            RowBox[{"Gamma", "[", 
             FractionBox[
              RowBox[{"i", "-", "1"}], "4"], "]"}]}], 
           RowBox[{"4", 
            RowBox[{"Gamma", "[", 
             FractionBox[
              RowBox[{"1", "+", "i"}], "4"], "]"}]}]]}], ",", 
         RowBox[{"{", 
          RowBox[{"i", ",", "2", ",", 
           RowBox[{"Length", "[", "as", "]"}]}], "}"}]}], "]"}]}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"cng", "[", 
    RowBox[{"as_List", ",", "zs_Real", ",", "\[Rho]_"}], "]"}], ":=", 
   RowBox[{
    FractionBox[
     RowBox[{"2", "\[Rho]"}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SuperscriptBox["\[Rho]", "2"]}], ")"}], "2"]], 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       SqrtBox[
        RowBox[{"gzz", "[", 
         RowBox[{"as", ",", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             SuperscriptBox["\[Rho]", "2"]}], ")"}], " ", "zs"}]}], "]"}]], 
       SqrtBox[
        RowBox[{"1", "-", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{"1", "-", 
            SuperscriptBox["\[Rho]", "2"]}], ")"}], "4"]}]]], "-", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{
         RowBox[{"as", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          "zs", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SuperscriptBox["\[Rho]", "2"]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SNG", "[", 
    RowBox[{"as_List", ",", "zs_Real"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["2", "zs"]}], "+", 
    RowBox[{"2", 
     RowBox[{"as", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], 
     RowBox[{"Log", "[", "zs", "]"}]}], "+", 
    RowBox[{
     FractionBox["2", "zs"], 
     RowBox[{"IntSimpson", "[", 
      RowBox[{
       RowBox[{"cng", "[", 
        RowBox[{"as", ",", "zs", ",", "#"}], "]"}], "&"}], "]"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Findzs", "[", 
    RowBox[{"as_List", ",", "l_Real"}], "]"}], ":=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"zsLow", ",", "zsHigh", ",", "zsMid", ",", "lMid"}], "}"}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"zsLow", "=", "0.0001"}], ";", "\[IndentingNewLine]", 
      RowBox[{"zsHigh", "=", "0.99999"}], ";", "\[IndentingNewLine]", 
      RowBox[{"While", "[", 
       RowBox[{
        RowBox[{
         RowBox[{"zsHigh", "-", "zsLow"}], ">", 
         SuperscriptBox["10", 
          RowBox[{"-", "8"}]]}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"zsMid", "=", 
          FractionBox[
           RowBox[{"zsHigh", "+", "zsLow"}], "2"]}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"lMid", "=", 
          RowBox[{"IntSimpson", "[", 
           RowBox[{
            RowBox[{"cl", "[", 
             RowBox[{"as", ",", "zsMid", ",", "#"}], "]"}], "&"}], "]"}]}], 
         ";", "\[IndentingNewLine]", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"l", "<", "lMid"}], ",", 
           RowBox[{"zsHigh", "=", "zsMid"}], ",", 
           RowBox[{"zsLow", "=", "zsMid"}]}], "]"}]}]}], 
       "\[IndentingNewLine]", "]"}], ";", "\[IndentingNewLine]", 
      FractionBox[
       RowBox[{"zsHigh", "+", "zsLow"}], "2"]}]}], "\[IndentingNewLine]", 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Sample", "[", 
    RowBox[{"aSamples_List", ",", "lGrid_List", ",", "ns_Integer"}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "wlSamples", ",", "zs", ",", "quantiles", ",", "plot", ",", "tpTrue"}], 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"progress", "=", "0"}], ";", "\[IndentingNewLine]", 
      RowBox[{"wlSamples", "=", 
       RowBox[{"Table", "[", 
        RowBox[{
         RowBox[{"{", "}"}], ",", 
         RowBox[{"Length", "[", "lGrid", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"Do", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{
         RowBox[{"Do", "[", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{
            RowBox[{"zs", "=", 
             RowBox[{"Findzs", "[", 
              RowBox[{"as", ",", 
               RowBox[{
               "lGrid", "\[LeftDoubleBracket]", "li", 
                "\[RightDoubleBracket]"}]}], "]"}]}], ";", 
            "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
             "wlSamples", "\[LeftDoubleBracket]", "li", 
              "\[RightDoubleBracket]"}], "=", 
             RowBox[{
              RowBox[{"Prepend", "[", 
               RowBox[{
                RowBox[{"SNG", "[", 
                 RowBox[{"as", ",", "zs"}], "]"}], "-", 
                RowBox[{"SNGHorizon", "[", "as", "]"}]}], "]"}], "@", 
              RowBox[{
              "wlSamples", "\[LeftDoubleBracket]", "li", 
               "\[RightDoubleBracket]"}]}]}]}], ",", "\[IndentingNewLine]", 
           RowBox[{"{", 
            RowBox[{"li", ",", 
             RowBox[{"Length", "[", "lGrid", "]"}]}], "}"}]}], "]"}], ";", 
         "\[IndentingNewLine]", 
         RowBox[{"progress", "+=", "1"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", 
         RowBox[{"as", ",", "aSamples"}], "}"}]}], "\[IndentingNewLine]", 
       "]"}], ";", "\[IndentingNewLine]", "wlSamples"}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"MakePlot", "[", 
    RowBox[{"stanResult_StanResult", ",", 
     RowBox[{"ns_", ":", "1000"}], ",", 
     RowBox[{"aTrue_", ":", "Null"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"T", "=", 
        FractionBox["1", "\[Pi]"]}], ",", "lGrid", ",", "aSamples", ",", 
       "nSamples", ",", "quantiles", ",", "wlSamples", ",", "wlTrue"}], "}"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"lGrid", "=", 
       RowBox[{"Exp", "@", 
        RowBox[{"Range", "[", 
         RowBox[{
          RowBox[{"Log", "[", "0.05", "]"}], ",", 
          RowBox[{"Log", "[", "4", "]"}], ",", 
          FractionBox[
           RowBox[{
            RowBox[{"Log", "[", "4", "]"}], "-", 
            RowBox[{"Log", "[", "0.05", "]"}]}], "20"]}], "]"}]}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"aSamples", "=", 
       RowBox[{"Transpose", "[", 
        RowBox[{"GetStanResult", "[", 
         RowBox[{"stanResult", ",", "\"\<a\>\""}], "]"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"aSamples", "=", 
       RowBox[{"RandomSample", "[", 
        RowBox[{"aSamples", ",", 
         RowBox[{"Min", "[", 
          RowBox[{"ns", ",", 
           RowBox[{"Length", "[", "aSamples", "]"}]}], "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"nSamples", "=", 
       RowBox[{"Min", "[", 
        RowBox[{"ns", ",", 
         RowBox[{"Length", "[", "aSamples", "]"}]}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"wlSamples", "=", 
       RowBox[{"Sample", "[", 
        RowBox[{"aSamples", ",", "lGrid", ",", "nSamples"}], "]"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"quantiles", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"Quantile", "[", 
          RowBox[{"#", ",", 
           RowBox[{"{", 
            RowBox[{
            "0.025", ",", "0.25", ",", "0.5", ",", "0.75", ",", "0.975"}], 
            "}"}]}], "]"}], "&"}], "/@", "wlSamples"}]}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"plot", "=", 
       RowBox[{"ListPlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Thread", "[", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"T", " ", "lGrid"}], ",", 
              RowBox[{
               FractionBox["1", "\[Pi]"], "#"}]}], "}"}], "]"}], "&"}], "/@", 
          
          RowBox[{"Transpose", "[", "quantiles", "]"}]}], ",", 
         RowBox[{"AxesLabel", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "\"\<\!\(\*SuperscriptBox[\(T\), \(\\\ \)]\)\[ScriptL]\>\"", ",", 
            "\"\<\!\(\*FractionBox[\(\[Alpha]'\\\ V\), \(T\\\ \
\*SuperscriptBox[\(R\), \(2\)]\)]\)\>\""}], "}"}]}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
           "LightGray", ",", "Gray", ",", "Black", ",", "Gray", ",", 
            "LightGray"}], "}"}]}], ",", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"0", ",", "1.25"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
              RowBox[{"-", "3"}], ",", "1.5"}], "}"}]}], "}"}]}]}], "]"}]}], 
      ";", "\[IndentingNewLine]", 
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"aTrue", "=!=", "Null"}], ",", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"wlTrue", "=", 
          RowBox[{
           RowBox[{
            RowBox[{"{", 
             RowBox[{
              RowBox[{"T", " ", "#"}], ",", 
              RowBox[{
               FractionBox["1", "\[Pi]"], 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"SNG", "[", 
                  RowBox[{"aTrue", ",", 
                   RowBox[{"Findzs", "[", 
                    RowBox[{"aTrue", ",", "#"}], "]"}]}], "]"}], "-", 
                 RowBox[{"SNGHorizon", "[", "aTrue", "]"}]}], ")"}]}]}], 
             "}"}], "&"}], "/@", "lGrid"}]}], ";", "\[IndentingNewLine]", 
         RowBox[{"Show", "[", 
          RowBox[{"plot", ",", 
           RowBox[{"ListPlot", "[", 
            RowBox[{"wlTrue", ",", 
             RowBox[{"PlotStyle", "\[Rule]", 
              RowBox[{"{", 
               RowBox[{"Red", ",", "Dashed"}], "}"}]}], ",", 
             RowBox[{"Joined", "\[Rule]", "True"}]}], "]"}]}], "]"}]}], ",", 
        "\[IndentingNewLine]", "plot"}], "\[IndentingNewLine]", "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"End", "[", "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"PlotSpatialWilson", "[", 
   RowBox[{"stanResult_StanResult", ",", 
    RowBox[{"ns_", ":", "1000"}], ",", 
    RowBox[{"aTrue_", ":", "Null"}]}], "]"}], ":=", 
  RowBox[{"Monitor", "[", 
   RowBox[{
    RowBox[{"SpatialWilson`MakePlot", "[", 
     RowBox[{"stanResult", ",", "ns", ",", "aTrue"}], "]"}], ",", 
    "SpatialWilson`progress"}], "]"}]}]}], "Input",
 CellLabel->"In[86]:=",ExpressionUUID->"a3af38be-c3c8-428b-a917-fdd9e7e338ba"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Summaries", "Subsection",ExpressionUUID->"ee42560e-9e32-4e5a-ac19-051e59d743f4"],

Cell[BoxData[{
 RowBox[{"GetStanResult", "[", 
  RowBox[{"Mean", ",", "stanResult", ",", "\"\<a\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"GetStanResult", "[", 
  RowBox[{"Median", ",", "stanResult", ",", "\"\<a\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"GetStanResult", "[", 
  RowBox[{"StandardDeviation", ",", "stanResult", ",", "\"\<a\>\""}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Histograms", "[", 
  RowBox[{"stanResult", ",", "\"\<a\>\"", ",", "aData"}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"GetStanResult", "[", 
  RowBox[{"SmoothHistogram", ",", "stanResult", ",", "\"\<scale\>\""}], 
  "]"}]}], "Input",
 CellLabel->
  "In[101]:=",ExpressionUUID->"d1478604-0414-4e7f-9117-aaee2b98bbac"],

Cell[BoxData[
 RowBox[{"GetStanResult", "[", 
  RowBox[{"Mean", ",", "stanResult", ",", "\"\<scale\>\""}], "]"}]], "Input",
 CellLabel->"In[91]:=",ExpressionUUID->"1919fe23-ac90-4da0-bd44-0b3b0eb01a5c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Trace plots", "Subsection",ExpressionUUID->"b19ef1a7-c424-4983-a3d8-718de0b481c9"],

Cell[BoxData[
 RowBox[{"TracePlots", "[", 
  RowBox[{"stanResult", ",", "\"\<b\>\""}], "]"}]], "Input",
 CellLabel->
  "In[106]:=",ExpressionUUID->"448c3d0e-6669-4da6-ade5-f619a796ebf2"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Scatter plots", "Subsection",ExpressionUUID->"af907c72-4a32-4d70-bfb6-f96577e4bba7"],

Cell[BoxData[
 RowBox[{"ScatterPlots", "[", 
  RowBox[{"stanResult", ",", "\"\<a\>\"", ",", "aData"}], "]"}]], "Input",
 CellLabel->
  "In[107]:=",ExpressionUUID->"36147248-4dde-4737-9a97-c728092b05d1"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "Inferred ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["z", "*"], TraditionalForm]],ExpressionUUID->
  "824dd12c-6989-44ef-aec3-ddd1c4846da3"]
}], "Subsection",ExpressionUUID->"79a35cf9-ea2e-45b3-8151-d4201197a33d"],

Cell[BoxData[
 RowBox[{"Plotzs", "[", 
  RowBox[{"stanResult", ",", "zsData"}], "]"}]], "Input",
 CellLabel->
  "In[108]:=",ExpressionUUID->"8f6a6fea-4c12-41c6-9733-4e8fdae497a0"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Metric", "Subsection",ExpressionUUID->"1a3f6432-6873-4604-b13d-6163b9919473"],

Cell[BoxData[
 RowBox[{"metricPlot", "=", 
  RowBox[{"PlotMetric", "[", 
   RowBox[{"stanResult", ",", "aData"}], "]"}]}]], "Input",
 CellLabel->
  "In[109]:=",ExpressionUUID->"e123f7fd-8e87-4538-b0ff-6b0c062a0378"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Entropy", "Subsection",ExpressionUUID->"c74ee7f7-f57c-4922-8e58-7ffc86c192d3"],

Cell[BoxData[
 RowBox[{"LogPlotEntropy", "[", 
  RowBox[{"stanResult", ",", 
   FractionBox["scaleData", 
    SuperscriptBox["zsData", "3"]]}], "]"}]], "Input",
 CellLabel->
  "In[110]:=",ExpressionUUID->"05b35dc3-fd58-44bb-974f-35c5f982ef40"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Two-point function", "Subsection",ExpressionUUID->"bca64e0b-32d5-44aa-b93b-3c0a6eff669d"],

Cell[BoxData[
 RowBox[{"twoPtPlot", "=", 
  RowBox[{"PlotTwoPoint", "[", 
   RowBox[{"stanResult", ",", "1000", ",", "aData"}], "]"}]}]], "Input",
 CellLabel->
  "In[116]:=",ExpressionUUID->"183a8886-df4a-4cc6-b31c-bd0ea5dac9e5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Temporal Wilson loop", "Subsection",ExpressionUUID->"84907a29-1fe3-465c-addf-8543975c085e"],

Cell[BoxData[
 RowBox[{"wilsonPlot", "=", 
  RowBox[{"PlotWilson", "[", 
   RowBox[{"stanResult", ",", "1000", ",", "aData"}], "]"}]}]], "Input",
 CellLabel->
  "In[117]:=",ExpressionUUID->"5d563f66-edf4-49e0-b594-a37a33210426"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Spatial Wilson loop", "Subsection",ExpressionUUID->"4f7622c2-2054-4857-b30f-6b447160ccde"],

Cell[BoxData[
 RowBox[{"spatialWilsonPlot", "=", 
  RowBox[{"PlotSpatialWilson", "[", 
   RowBox[{"stanResult", ",", "1000", ",", "aData"}], "]"}]}]], "Input",
 CellLabel->
  "In[118]:=",ExpressionUUID->"71b5c1e5-6577-4063-a262-62a1225ba9c9"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1254, 1380},
WindowMargins->{{Automatic, 18}, {18, Automatic}},
TaggingRules->{"TryRealOnly" -> False},
FrontEndVersion->"12.1 for Linux x86 (64-bit) (March 14, 2020)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"ce26dfe4-b845-4b1e-aad9-d20916f84ad8"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 119, 0, 98, "Title",ExpressionUUID->"56df2183-e8f0-40f9-b484-1b00d0f38243"],
Cell[CellGroupData[{
Cell[724, 26, 243, 6, 69, "Chapter",ExpressionUUID->"aa38f7fa-8e5f-4b9c-a5cf-966efaeb2a17"],
Cell[970, 34, 1279, 41, 177, "Text",ExpressionUUID->"325fa363-c36d-454e-b1ee-06d36d375ca7"]
}, Open  ]],
Cell[CellGroupData[{
Cell[2286, 80, 250, 7, 69, "Chapter",ExpressionUUID->"b3f80500-13a9-43a3-b32f-cbe215e07906"],
Cell[2539, 89, 737, 21, 35, "Text",ExpressionUUID->"72a70943-f663-4ab6-ab5c-e14c40dc7760"],
Cell[3279, 112, 882, 28, 68, "Text",ExpressionUUID->"a5617d75-f9fb-4730-94a0-6e861bbf4d96"],
Cell[4164, 142, 2243, 70, 107, "Text",ExpressionUUID->"c89512ae-c7b7-4de0-95f0-c497db3a86c7"],
Cell[CellGroupData[{
Cell[6432, 216, 103, 0, 67, "Section",ExpressionUUID->"e0849b28-46fd-4273-8f6b-3cd8b853bbe7"],
Cell[6538, 218, 217, 3, 35, "Text",ExpressionUUID->"79faac28-3299-4248-9cf0-05b78d5f2aba"],
Cell[6758, 223, 4208, 138, 299, "Text",ExpressionUUID->"dfb92b9f-318a-4486-8653-9a3249466793"],
Cell[10969, 363, 5728, 194, 256, "Text",ExpressionUUID->"e7f61f9c-3946-4821-91e7-44f29fce3e4e"],
Cell[16700, 559, 732, 22, 35, "Text",ExpressionUUID->"31365504-c916-43ca-8acc-2e8cb90ccdde"],
Cell[17435, 583, 3900, 132, 312, "Input",ExpressionUUID->"83a40a8d-3f23-4e5b-8497-20521f91323d"],
Cell[21338, 717, 4097, 136, 252, "Text",ExpressionUUID->"86470fcd-0e48-4e8a-98fb-1a4332136add"],
Cell[25438, 855, 2054, 65, 120, "Input",ExpressionUUID->"7bfb20ed-9650-4b1a-9236-5668fb9ea9df"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[27541, 926, 267, 7, 69, "Chapter",ExpressionUUID->"5acfee8b-7ba1-42f1-ac11-0d34a04a0541"],
Cell[27811, 935, 831, 21, 53, "Input",ExpressionUUID->"10245dd2-1024-4708-8467-386f38d99d0e"],
Cell[CellGroupData[{
Cell[28667, 960, 87, 0, 67, "Section",ExpressionUUID->"7d171a86-9a43-4b60-aa0f-62949a6ea516"],
Cell[28757, 962, 189, 3, 35, "Text",ExpressionUUID->"be6e37e4-2a93-4ae5-abf0-f360f68efa6e"],
Cell[28949, 967, 462, 13, 30, "Input",ExpressionUUID->"3c0eb1af-217b-403b-b9b7-e50fa2a8c417"],
Cell[29414, 982, 1319, 37, 127, "Input",ExpressionUUID->"44f56192-94ff-4a06-ba99-002abf03b6e5"],
Cell[30736, 1021, 1355, 42, 195, "Input",ExpressionUUID->"03b5ccc2-83fd-4f66-a75e-a7a24f4b0e18"],
Cell[32094, 1065, 148, 2, 35, "Text",ExpressionUUID->"b2e7ef38-686e-4564-815e-70c7c1eb241a"],
Cell[32245, 1069, 428, 11, 53, "Input",ExpressionUUID->"e9c211bc-3898-4a37-9e0f-3fa07bd00f5e"],
Cell[32676, 1082, 2347, 67, 126, "Input",ExpressionUUID->"959ee65d-4157-4390-8538-9fe92c22745a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35060, 1154, 94, 0, 67, "Section",ExpressionUUID->"f077fcc6-16d6-4957-8821-dd5892447070"],
Cell[35157, 1156, 402, 11, 58, "Text",ExpressionUUID->"56f71cc3-8529-4471-ae74-8c70d7f90208"],
Cell[35562, 1169, 271, 6, 35, "Text",ExpressionUUID->"6c339785-5643-44cc-987c-4e852332c71a"],
Cell[35836, 1177, 568, 14, 75, "Input",ExpressionUUID->"3c799f99-ad23-40ce-8df4-fe68bb4ea1d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[36441, 1196, 103, 0, 67, "Section",ExpressionUUID->"9d4b6bc3-bb89-4b2e-9065-81406692722c"],
Cell[36547, 1198, 91, 0, 35, "Text",ExpressionUUID->"f30d86c8-b366-497e-8059-def72e70335a"],
Cell[36641, 1200, 346, 8, 30, "Input",ExpressionUUID->"bc4cdc16-d12a-4080-a051-c01a302f2364"],
Cell[36990, 1210, 243, 5, 35, "Text",ExpressionUUID->"1f03f9ab-dcd6-48c3-9831-bb093ac5309a"],
Cell[37236, 1217, 799, 16, 75, "Input",ExpressionUUID->"cc1d0b8d-f4be-47ad-81af-3643fccd61c8"],
Cell[38038, 1235, 812, 23, 35, "Text",ExpressionUUID->"d10954bf-5166-47ff-8a1e-cc00d0504b65"],
Cell[38853, 1260, 533, 14, 53, "Input",ExpressionUUID->"a43c91eb-3a83-4019-a999-ff0a687f6198"],
Cell[39389, 1276, 109, 0, 35, "Text",ExpressionUUID->"5be2dbb0-a5d9-48d3-a964-df69f0d284ab"],
Cell[39501, 1278, 511, 13, 30, "Input",ExpressionUUID->"e8079a24-28a6-4bd3-8ea1-ce5dae8530ed"],
Cell[40015, 1293, 467, 10, 30, "Input",ExpressionUUID->"4a1a0e20-6172-4239-b718-4eea9e39710d"],
Cell[40485, 1305, 89, 0, 35, "Text",ExpressionUUID->"2c1a7821-53bd-403b-bf87-460f50af0ae8"],
Cell[40577, 1307, 211, 4, 30, "Input",ExpressionUUID->"a293c52a-d95a-4d77-8068-09136524ea08"],
Cell[40791, 1313, 88, 0, 35, "Text",ExpressionUUID->"46dbea91-9164-477e-a1c3-ccc033c47501"],
Cell[40882, 1315, 540, 13, 75, "Input",ExpressionUUID->"3e3301cb-201c-4b6a-ba9c-f8a1eba7e5fa"],
Cell[41425, 1330, 155, 2, 35, "Text",ExpressionUUID->"688ff7d6-62ca-4cfd-beea-8470d7d9071d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41617, 1337, 93, 0, 67, "Section",ExpressionUUID->"84c96554-0430-4533-9957-464c26c875db"],
Cell[41713, 1339, 572, 9, 102, "Text",ExpressionUUID->"c0319981-4861-4d56-b0a8-4a52206fa427"],
Cell[42288, 1350, 346, 8, 30, "Input",ExpressionUUID->"2f51ecd3-eb50-4dd0-bccd-0acb58b08e50"],
Cell[42637, 1360, 872, 18, 75, "Input",ExpressionUUID->"9e351d5f-56ac-4b78-a8d9-596ed09c0198"],
Cell[43512, 1380, 798, 18, 75, "Input",ExpressionUUID->"b3f0f47e-f6f2-4507-93c4-c79773578817"]
}, Open  ]],
Cell[CellGroupData[{
Cell[44347, 1403, 93, 0, 67, "Section",ExpressionUUID->"cf2ea9b1-ec1e-46b0-acce-f15baf1f7ee8"],
Cell[44443, 1405, 84, 0, 35, "Text",ExpressionUUID->"79181ae7-4f88-45ec-b92a-7f33a929d1b8"],
Cell[44530, 1407, 193, 3, 30, "Input",ExpressionUUID->"3475b7cb-80fd-4e35-8549-6142ab0667ea"],
Cell[44726, 1412, 250, 6, 30, "Input",ExpressionUUID->"27a53867-5a22-454e-ab40-4043feebc860"],
Cell[44979, 1420, 406, 9, 30, "Input",ExpressionUUID->"f12e18d9-c901-45b6-b7cf-7cfa8cbda7c2"],
Cell[CellGroupData[{
Cell[45410, 1433, 93, 0, 54, "Subsection",ExpressionUUID->"d08b964f-de97-4f71-8958-5b1cced54785"],
Cell[45506, 1435, 20120, 534, 1624, "Input",ExpressionUUID->"84352394-77b7-4dbf-84f1-d5b6f5c85776"],
Cell[CellGroupData[{
Cell[65651, 1973, 98, 0, 45, "Subsubsection",ExpressionUUID->"a7e24ad3-758b-48c1-8d28-3214da877b98"],
Cell[65752, 1975, 13603, 386, 1324, "Input",ExpressionUUID->"90019644-7056-423b-8ae0-a4012c33912d"]
}, Open  ]],
Cell[CellGroupData[{
Cell[79392, 2366, 100, 0, 45, "Subsubsection",ExpressionUUID->"ef561333-8811-48e2-86e9-bffef209fe80"],
Cell[79495, 2368, 6385, 207, 364, "Text",ExpressionUUID->"9c89a133-f489-4c35-bb1f-39cd92044df6"],
Cell[85883, 2577, 1450, 45, 121, "Text",ExpressionUUID->"bdf821d2-a2f1-4ab7-88d2-4099567e6c07"],
Cell[87336, 2624, 19953, 554, 1954, "Input",ExpressionUUID->"78c3847b-13ed-478f-92ab-c5f527768ad4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107326, 3183, 99, 0, 45, "Subsubsection",ExpressionUUID->"1be514bb-0373-41c0-89c7-600106a75237"],
Cell[107428, 3185, 5382, 180, 346, "Text",ExpressionUUID->"c0a4be44-5976-446b-af57-ed0e83e96bda"],
Cell[112813, 3367, 18018, 526, 1717, "Input",ExpressionUUID->"a3af38be-c3c8-428b-a917-fdd9e7e338ba"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[130880, 3899, 86, 0, 54, "Subsection",ExpressionUUID->"ee42560e-9e32-4e5a-ac19-051e59d743f4"],
Cell[130969, 3901, 727, 17, 119, "Input",ExpressionUUID->"d1478604-0414-4e7f-9117-aaee2b98bbac"],
Cell[131699, 3920, 202, 3, 30, "Input",ExpressionUUID->"1919fe23-ac90-4da0-bd44-0b3b0eb01a5c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[131938, 3928, 88, 0, 54, "Subsection",ExpressionUUID->"b19ef1a7-c424-4983-a3d8-718de0b481c9"],
Cell[132029, 3930, 186, 4, 30, "Input",ExpressionUUID->"448c3d0e-6669-4da6-ade5-f619a796ebf2"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132252, 3939, 90, 0, 54, "Subsection",ExpressionUUID->"af907c72-4a32-4d70-bfb6-f96577e4bba7"],
Cell[132345, 3941, 202, 4, 30, "Input",ExpressionUUID->"36147248-4dde-4737-9a97-c728092b05d1"]
}, Open  ]],
Cell[CellGroupData[{
Cell[132584, 3950, 232, 6, 54, "Subsection",ExpressionUUID->"79a35cf9-ea2e-45b3-8151-d4201197a33d"],
Cell[132819, 3958, 179, 4, 30, "Input",ExpressionUUID->"8f6a6fea-4c12-41c6-9733-4e8fdae497a0"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133035, 3967, 83, 0, 54, "Subsection",ExpressionUUID->"1a3f6432-6873-4604-b13d-6163b9919473"],
Cell[133121, 3969, 215, 5, 30, "Input",ExpressionUUID->"e123f7fd-8e87-4538-b0ff-6b0c062a0378"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133373, 3979, 84, 0, 54, "Subsection",ExpressionUUID->"c74ee7f7-f57c-4922-8e58-7ffc86c192d3"],
Cell[133460, 3981, 243, 6, 50, "Input",ExpressionUUID->"05b35dc3-fd58-44bb-974f-35c5f982ef40"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133740, 3992, 95, 0, 54, "Subsection",ExpressionUUID->"bca64e0b-32d5-44aa-b93b-3c0a6eff669d"],
Cell[133838, 3994, 229, 5, 30, "Input",ExpressionUUID->"183a8886-df4a-4cc6-b31c-bd0ea5dac9e5"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134104, 4004, 97, 0, 54, "Subsection",ExpressionUUID->"84907a29-1fe3-465c-addf-8543975c085e"],
Cell[134204, 4006, 228, 5, 30, "Input",ExpressionUUID->"5d563f66-edf4-49e0-b594-a37a33210426"]
}, Open  ]],
Cell[CellGroupData[{
Cell[134469, 4016, 96, 0, 54, "Subsection",ExpressionUUID->"4f7622c2-2054-4857-b30f-6b447160ccde"],
Cell[134568, 4018, 242, 5, 30, "Input",ExpressionUUID->"71b5c1e5-6577-4063-a262-62a1225ba9c9"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

